/* eslint-disable */
//prettier-ignore
module.exports = {
name: "@yarnpkg/plugin-catalogs",
factory: function (require) {
"use strict";var plugin=(()=>{var Pt=Object.create;var _e=Object.defineProperty;var Mt=Object.getOwnPropertyDescriptor;var Bt=Object.getOwnPropertyNames;var jt=Object.getPrototypeOf,Wt=Object.prototype.hasOwnProperty;var ue=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(r,t)=>(typeof require<"u"?require:r)[t]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var ce=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports),Ft=(e,r)=>{for(var t in r)_e(e,t,{get:r[t],enumerable:!0})},Ze=(e,r,t,o)=>{if(r&&typeof r=="object"||typeof r=="function")for(let n of Bt(r))!Wt.call(e,n)&&n!==t&&_e(e,n,{get:()=>r[n],enumerable:!(o=Mt(r,n))||o.enumerable});return e};var Ee=(e,r,t)=>(t=e!=null?Pt(jt(e)):{},Ze(r||!e||!e.__esModule?_e(t,"default",{value:e,enumerable:!0}):t,e)),Ut=e=>Ze(_e({},"__esModule",{value:!0}),e);var Ae=ce((Jr,gt)=>{"use strict";var J="\\\\/",ct=`[^${J}]`,re="\\.",sr="\\+",ir="\\?",ve="\\/",ar="(?=.)",lt="[^/]",Ge=`(?:${ve}|$)`,ft=`(?:^|${ve})`,Pe=`${re}{1,2}${Ge}`,ur=`(?!${re})`,cr=`(?!${ft}${Pe})`,lr=`(?!${re}{0,1}${Ge})`,fr=`(?!${Pe})`,pr=`[^.${ve}]`,gr=`${lt}*?`,dr="/",pt={DOT_LITERAL:re,PLUS_LITERAL:sr,QMARK_LITERAL:ir,SLASH_LITERAL:ve,ONE_CHAR:ar,QMARK:lt,END_ANCHOR:Ge,DOTS_SLASH:Pe,NO_DOT:ur,NO_DOTS:cr,NO_DOT_SLASH:lr,NO_DOTS_SLASH:fr,QMARK_NO_DOT:pr,STAR:gr,START_ANCHOR:ft,SEP:dr},hr={...pt,SLASH_LITERAL:`[${J}]`,QMARK:ct,STAR:`${ct}*?`,DOTS_SLASH:`${re}{1,2}(?:[${J}]|$)`,NO_DOT:`(?!${re})`,NO_DOTS:`(?!(?:^|[${J}])${re}{1,2}(?:[${J}]|$))`,NO_DOT_SLASH:`(?!${re}{0,1}(?:[${J}]|$))`,NO_DOTS_SLASH:`(?!${re}{1,2}(?:[${J}]|$))`,QMARK_NO_DOT:`[^.${J}]`,START_ANCHOR:`(?:^|[${J}])`,END_ANCHOR:`(?:[${J}]|$)`,SEP:"\\"},Ar={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};gt.exports={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:Ar,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,extglobChars(e){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${e.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(e){return e===!0?hr:pt}}});var Re=ce(B=>{"use strict";var{REGEX_BACKSLASH:Rr,REGEX_REMOVE_BACKSLASH:br,REGEX_SPECIAL_CHARS:mr,REGEX_SPECIAL_CHARS_GLOBAL:yr}=Ae();B.isObject=e=>e!==null&&typeof e=="object"&&!Array.isArray(e);B.hasRegexChars=e=>mr.test(e);B.isRegexChar=e=>e.length===1&&B.hasRegexChars(e);B.escapeRegex=e=>e.replace(yr,"\\$1");B.toPosixSlashes=e=>e.replace(Rr,"/");B.isWindows=()=>{if(typeof navigator<"u"&&navigator.platform){let e=navigator.platform.toLowerCase();return e==="win32"||e==="windows"}return typeof process<"u"&&process.platform?process.platform==="win32":!1};B.removeBackslashes=e=>e.replace(br,r=>r==="\\"?"":r);B.escapeLast=(e,r,t)=>{let o=e.lastIndexOf(r,t);return o===-1?e:e[o-1]==="\\"?B.escapeLast(e,r,o-1):`${e.slice(0,o)}\\${e.slice(o)}`};B.removePrefix=(e,r={})=>{let t=e;return t.startsWith("./")&&(t=t.slice(2),r.prefix="./"),t};B.wrapOutput=(e,r={},t={})=>{let o=t.contains?"":"^",n=t.contains?"":"$",s=`${o}(?:${e})${n}`;return r.negated===!0&&(s=`(?:^(?!${s}).*$)`),s};B.basename=(e,{windows:r}={})=>{let t=e.split(r?/[\\/]/:"/"),o=t[t.length-1];return o===""?t[t.length-2]:o}});var Ct=ce((to,yt)=>{"use strict";var dt=Re(),{CHAR_ASTERISK:Me,CHAR_AT:Cr,CHAR_BACKWARD_SLASH:be,CHAR_COMMA:_r,CHAR_DOT:Be,CHAR_EXCLAMATION_MARK:je,CHAR_FORWARD_SLASH:mt,CHAR_LEFT_CURLY_BRACE:We,CHAR_LEFT_PARENTHESES:Fe,CHAR_LEFT_SQUARE_BRACKET:Er,CHAR_PLUS:Or,CHAR_QUESTION_MARK:ht,CHAR_RIGHT_CURLY_BRACE:xr,CHAR_RIGHT_PARENTHESES:At,CHAR_RIGHT_SQUARE_BRACKET:Sr}=Ae(),Rt=e=>e===mt||e===be,bt=e=>{e.isPrefix!==!0&&(e.depth=e.isGlobstar?1/0:1)},vr=(e,r)=>{let t=r||{},o=e.length-1,n=t.parts===!0||t.scanToEnd===!0,s=[],c=[],p=[],g=e,h=-1,m=0,$=0,I=!1,F=!1,y=!1,H=!1,se=!1,Z=!1,_=!1,z=!1,ie=!1,D=!1,N=0,U,d,R={value:"",depth:0,isGlob:!1},u=()=>h>=o,M=()=>g.charCodeAt(h+1),k=()=>(U=d,g.charCodeAt(++h));for(;h<o;){d=k();let C;if(d===be){_=R.backslashes=!0,d=k(),d===We&&(Z=!0);continue}if(Z===!0||d===We){for(N++;u()!==!0&&(d=k());){if(d===be){_=R.backslashes=!0,k();continue}if(d===We){N++;continue}if(Z!==!0&&d===Be&&(d=k())===Be){if(I=R.isBrace=!0,y=R.isGlob=!0,D=!0,n===!0)continue;break}if(Z!==!0&&d===_r){if(I=R.isBrace=!0,y=R.isGlob=!0,D=!0,n===!0)continue;break}if(d===xr&&(N--,N===0)){Z=!1,I=R.isBrace=!0,D=!0;break}}if(n===!0)continue;break}if(d===mt){if(s.push(h),c.push(R),R={value:"",depth:0,isGlob:!1},D===!0)continue;if(U===Be&&h===m+1){m+=2;continue}$=h+1;continue}if(t.noext!==!0&&(d===Or||d===Cr||d===Me||d===ht||d===je)===!0&&M()===Fe){if(y=R.isGlob=!0,H=R.isExtglob=!0,D=!0,d===je&&h===m&&(ie=!0),n===!0){for(;u()!==!0&&(d=k());){if(d===be){_=R.backslashes=!0,d=k();continue}if(d===At){y=R.isGlob=!0,D=!0;break}}continue}break}if(d===Me){if(U===Me&&(se=R.isGlobstar=!0),y=R.isGlob=!0,D=!0,n===!0)continue;break}if(d===ht){if(y=R.isGlob=!0,D=!0,n===!0)continue;break}if(d===Er){for(;u()!==!0&&(C=k());){if(C===be){_=R.backslashes=!0,k();continue}if(C===Sr){F=R.isBracket=!0,y=R.isGlob=!0,D=!0;break}}if(n===!0)continue;break}if(t.nonegate!==!0&&d===je&&h===m){z=R.negated=!0,m++;continue}if(t.noparen!==!0&&d===Fe){if(y=R.isGlob=!0,n===!0){for(;u()!==!0&&(d=k());){if(d===Fe){_=R.backslashes=!0,d=k();continue}if(d===At){D=!0;break}}continue}break}if(y===!0){if(D=!0,n===!0)continue;break}}t.noext===!0&&(H=!1,y=!1);let T=g,i="",a="";m>0&&(i=g.slice(0,m),g=g.slice(m),$-=m),T&&y===!0&&$>0?(T=g.slice(0,$),a=g.slice($)):y===!0?(T="",a=g):T=g,T&&T!==""&&T!=="/"&&T!==g&&Rt(T.charCodeAt(T.length-1))&&(T=T.slice(0,-1)),t.unescape===!0&&(a&&(a=dt.removeBackslashes(a)),T&&_===!0&&(T=dt.removeBackslashes(T)));let K={prefix:i,input:e,start:m,base:T,glob:a,isBrace:I,isBracket:F,isGlob:y,isExtglob:H,isGlobstar:se,negated:z,negatedExtglob:ie};if(t.tokens===!0&&(K.maxDepth=0,Rt(d)||c.push(R),K.tokens=c),t.parts===!0||t.tokens===!0){let C;for(let x=0;x<s.length;x++){let te=C?C+1:m,X=s[x],oe=e.slice(te,X);t.tokens&&(x===0&&m!==0?(c[x].isPrefix=!0,c[x].value=i):c[x].value=oe,bt(c[x]),K.maxDepth+=c[x].depth),(x!==0||oe!=="")&&p.push(oe),C=X}if(C&&C+1<e.length){let x=e.slice(C+1);p.push(x),t.tokens&&(c[c.length-1].value=x,bt(c[c.length-1]),K.maxDepth+=c[c.length-1].depth)}K.slashes=s,K.parts=p}return K};yt.exports=vr});var Ot=ce((ro,Et)=>{"use strict";var Te=Ae(),ee=Re(),{MAX_LENGTH:Le,POSIX_REGEX_SOURCE:Tr,REGEX_NON_SPECIAL_CHARS:Lr,REGEX_SPECIAL_CHARS_BACKREF:$r,REPLACEMENTS:_t}=Te,Ir=(e,r)=>{if(typeof r.expandRange=="function")return r.expandRange(...e,r);e.sort();let t=`[${e.join("-")}]`;try{new RegExp(t)}catch{return e.map(n=>ee.escapeRegex(n)).join("..")}return t},ge=(e,r)=>`Missing ${e}: "${r}" - use "\\\\${r}" to match literal characters`,Ue=(e,r)=>{if(typeof e!="string")throw new TypeError("Expected a string");e=_t[e]||e;let t={...r},o=typeof t.maxLength=="number"?Math.min(Le,t.maxLength):Le,n=e.length;if(n>o)throw new SyntaxError(`Input length: ${n}, exceeds maximum allowed length: ${o}`);let s={type:"bos",value:"",output:t.prepend||""},c=[s],p=t.capture?"":"?:",g=Te.globChars(t.windows),h=Te.extglobChars(g),{DOT_LITERAL:m,PLUS_LITERAL:$,SLASH_LITERAL:I,ONE_CHAR:F,DOTS_SLASH:y,NO_DOT:H,NO_DOT_SLASH:se,NO_DOTS_SLASH:Z,QMARK:_,QMARK_NO_DOT:z,STAR:ie,START_ANCHOR:D}=g,N=f=>`(${p}(?:(?!${D}${f.dot?y:m}).)*?)`,U=t.dot?"":H,d=t.dot?_:z,R=t.bash===!0?N(t):ie;t.capture&&(R=`(${R})`),typeof t.noext=="boolean"&&(t.noextglob=t.noext);let u={input:e,index:-1,start:0,dot:t.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:c};e=ee.removePrefix(e,u),n=e.length;let M=[],k=[],T=[],i=s,a,K=()=>u.index===n-1,C=u.peek=(f=1)=>e[u.index+f],x=u.advance=()=>e[++u.index]||"",te=()=>e.slice(u.index+1),X=(f="",E=0)=>{u.consumed+=f,u.index+=E},oe=f=>{u.output+=f.output!=null?f.output:f.value,X(f.value)},Dt=()=>{let f=1;for(;C()==="!"&&(C(2)!=="("||C(3)==="?");)x(),u.start++,f++;return f%2===0?!1:(u.negated=!0,u.start++,!0)},me=f=>{u[f]++,T.push(f)},ae=f=>{u[f]--,T.pop()},b=f=>{if(i.type==="globstar"){let E=u.braces>0&&(f.type==="comma"||f.type==="brace"),l=f.extglob===!0||M.length&&(f.type==="pipe"||f.type==="paren");f.type!=="slash"&&f.type!=="paren"&&!E&&!l&&(u.output=u.output.slice(0,-i.output.length),i.type="star",i.value="*",i.output=R,u.output+=i.output)}if(M.length&&f.type!=="paren"&&(M[M.length-1].inner+=f.value),(f.value||f.output)&&oe(f),i&&i.type==="text"&&f.type==="text"){i.output=(i.output||i.value)+f.value,i.value+=f.value;return}f.prev=i,c.push(f),i=f},ye=(f,E)=>{let l={...h[E],conditions:1,inner:""};l.prev=i,l.parens=u.parens,l.output=u.output;let A=(t.capture?"(":"")+l.open;me("parens"),b({type:f,value:E,output:u.output?"":F}),b({type:"paren",extglob:!0,value:x(),output:A}),M.push(l)},Gt=f=>{let E=f.close+(t.capture?")":""),l;if(f.type==="negate"){let A=R;if(f.inner&&f.inner.length>1&&f.inner.includes("/")&&(A=N(t)),(A!==R||K()||/^\)+$/.test(te()))&&(E=f.close=`)$))${A}`),f.inner.includes("*")&&(l=te())&&/^\.[^\\/.]+$/.test(l)){let S=Ue(l,{...r,fastpaths:!1}).output;E=f.close=`)${S})${A})`}f.prev.type==="bos"&&(u.negatedExtglob=!0)}b({type:"paren",extglob:!0,value:a,output:E}),ae("parens")};if(t.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(e)){let f=!1,E=e.replace($r,(l,A,S,G,w,ke)=>G==="\\"?(f=!0,l):G==="?"?A?A+G+(w?_.repeat(w.length):""):ke===0?d+(w?_.repeat(w.length):""):_.repeat(S.length):G==="."?m.repeat(S.length):G==="*"?A?A+G+(w?R:""):R:A?l:`\\${l}`);return f===!0&&(t.unescape===!0?E=E.replace(/\\/g,""):E=E.replace(/\\+/g,l=>l.length%2===0?"\\\\":l?"\\":"")),E===e&&t.contains===!0?(u.output=e,u):(u.output=ee.wrapOutput(E,u,r),u)}for(;!K();){if(a=x(),a==="\0")continue;if(a==="\\"){let l=C();if(l==="/"&&t.bash!==!0||l==="."||l===";")continue;if(!l){a+="\\",b({type:"text",value:a});continue}let A=/^\\+/.exec(te()),S=0;if(A&&A[0].length>2&&(S=A[0].length,u.index+=S,S%2!==0&&(a+="\\")),t.unescape===!0?a=x():a+=x(),u.brackets===0){b({type:"text",value:a});continue}}if(u.brackets>0&&(a!=="]"||i.value==="["||i.value==="[^")){if(t.posix!==!1&&a===":"){let l=i.value.slice(1);if(l.includes("[")&&(i.posix=!0,l.includes(":"))){let A=i.value.lastIndexOf("["),S=i.value.slice(0,A),G=i.value.slice(A+2),w=Tr[G];if(w){i.value=S+w,u.backtrack=!0,x(),!s.output&&c.indexOf(i)===1&&(s.output=F);continue}}}(a==="["&&C()!==":"||a==="-"&&C()==="]")&&(a=`\\${a}`),a==="]"&&(i.value==="["||i.value==="[^")&&(a=`\\${a}`),t.posix===!0&&a==="!"&&i.value==="["&&(a="^"),i.value+=a,oe({value:a});continue}if(u.quotes===1&&a!=='"'){a=ee.escapeRegex(a),i.value+=a,oe({value:a});continue}if(a==='"'){u.quotes=u.quotes===1?0:1,t.keepQuotes===!0&&b({type:"text",value:a});continue}if(a==="("){me("parens"),b({type:"paren",value:a});continue}if(a===")"){if(u.parens===0&&t.strictBrackets===!0)throw new SyntaxError(ge("opening","("));let l=M[M.length-1];if(l&&u.parens===l.parens+1){Gt(M.pop());continue}b({type:"paren",value:a,output:u.parens?")":"\\)"}),ae("parens");continue}if(a==="["){if(t.nobracket===!0||!te().includes("]")){if(t.nobracket!==!0&&t.strictBrackets===!0)throw new SyntaxError(ge("closing","]"));a=`\\${a}`}else me("brackets");b({type:"bracket",value:a});continue}if(a==="]"){if(t.nobracket===!0||i&&i.type==="bracket"&&i.value.length===1){b({type:"text",value:a,output:`\\${a}`});continue}if(u.brackets===0){if(t.strictBrackets===!0)throw new SyntaxError(ge("opening","["));b({type:"text",value:a,output:`\\${a}`});continue}ae("brackets");let l=i.value.slice(1);if(i.posix!==!0&&l[0]==="^"&&!l.includes("/")&&(a=`/${a}`),i.value+=a,oe({value:a}),t.literalBrackets===!1||ee.hasRegexChars(l))continue;let A=ee.escapeRegex(i.value);if(u.output=u.output.slice(0,-i.value.length),t.literalBrackets===!0){u.output+=A,i.value=A;continue}i.value=`(${p}${A}|${i.value})`,u.output+=i.value;continue}if(a==="{"&&t.nobrace!==!0){me("braces");let l={type:"brace",value:a,output:"(",outputIndex:u.output.length,tokensIndex:u.tokens.length};k.push(l),b(l);continue}if(a==="}"){let l=k[k.length-1];if(t.nobrace===!0||!l){b({type:"text",value:a,output:a});continue}let A=")";if(l.dots===!0){let S=c.slice(),G=[];for(let w=S.length-1;w>=0&&(c.pop(),S[w].type!=="brace");w--)S[w].type!=="dots"&&G.unshift(S[w].value);A=Ir(G,t),u.backtrack=!0}if(l.comma!==!0&&l.dots!==!0){let S=u.output.slice(0,l.outputIndex),G=u.tokens.slice(l.tokensIndex);l.value=l.output="\\{",a=A="\\}",u.output=S;for(let w of G)u.output+=w.output||w.value}b({type:"brace",value:a,output:A}),ae("braces"),k.pop();continue}if(a==="|"){M.length>0&&M[M.length-1].conditions++,b({type:"text",value:a});continue}if(a===","){let l=a,A=k[k.length-1];A&&T[T.length-1]==="braces"&&(A.comma=!0,l="|"),b({type:"comma",value:a,output:l});continue}if(a==="/"){if(i.type==="dot"&&u.index===u.start+1){u.start=u.index+1,u.consumed="",u.output="",c.pop(),i=s;continue}b({type:"slash",value:a,output:I});continue}if(a==="."){if(u.braces>0&&i.type==="dot"){i.value==="."&&(i.output=m);let l=k[k.length-1];i.type="dots",i.output+=a,i.value+=a,l.dots=!0;continue}if(u.braces+u.parens===0&&i.type!=="bos"&&i.type!=="slash"){b({type:"text",value:a,output:m});continue}b({type:"dot",value:a,output:m});continue}if(a==="?"){if(!(i&&i.value==="(")&&t.noextglob!==!0&&C()==="("&&C(2)!=="?"){ye("qmark",a);continue}if(i&&i.type==="paren"){let A=C(),S=a;(i.value==="("&&!/[!=<:]/.test(A)||A==="<"&&!/<([!=]|\w+>)/.test(te()))&&(S=`\\${a}`),b({type:"text",value:a,output:S});continue}if(t.dot!==!0&&(i.type==="slash"||i.type==="bos")){b({type:"qmark",value:a,output:z});continue}b({type:"qmark",value:a,output:_});continue}if(a==="!"){if(t.noextglob!==!0&&C()==="("&&(C(2)!=="?"||!/[!=<:]/.test(C(3)))){ye("negate",a);continue}if(t.nonegate!==!0&&u.index===0){Dt();continue}}if(a==="+"){if(t.noextglob!==!0&&C()==="("&&C(2)!=="?"){ye("plus",a);continue}if(i&&i.value==="("||t.regex===!1){b({type:"plus",value:a,output:$});continue}if(i&&(i.type==="bracket"||i.type==="paren"||i.type==="brace")||u.parens>0){b({type:"plus",value:a});continue}b({type:"plus",value:$});continue}if(a==="@"){if(t.noextglob!==!0&&C()==="("&&C(2)!=="?"){b({type:"at",extglob:!0,value:a,output:""});continue}b({type:"text",value:a});continue}if(a!=="*"){(a==="$"||a==="^")&&(a=`\\${a}`);let l=Lr.exec(te());l&&(a+=l[0],u.index+=l[0].length),b({type:"text",value:a});continue}if(i&&(i.type==="globstar"||i.star===!0)){i.type="star",i.star=!0,i.value+=a,i.output=R,u.backtrack=!0,u.globstar=!0,X(a);continue}let f=te();if(t.noextglob!==!0&&/^\([^?]/.test(f)){ye("star",a);continue}if(i.type==="star"){if(t.noglobstar===!0){X(a);continue}let l=i.prev,A=l.prev,S=l.type==="slash"||l.type==="bos",G=A&&(A.type==="star"||A.type==="globstar");if(t.bash===!0&&(!S||f[0]&&f[0]!=="/")){b({type:"star",value:a,output:""});continue}let w=u.braces>0&&(l.type==="comma"||l.type==="brace"),ke=M.length&&(l.type==="pipe"||l.type==="paren");if(!S&&l.type!=="paren"&&!w&&!ke){b({type:"star",value:a,output:""});continue}for(;f.slice(0,3)==="/**";){let Ce=e[u.index+4];if(Ce&&Ce!=="/")break;f=f.slice(3),X("/**",3)}if(l.type==="bos"&&K()){i.type="globstar",i.value+=a,i.output=N(t),u.output=i.output,u.globstar=!0,X(a);continue}if(l.type==="slash"&&l.prev.type!=="bos"&&!G&&K()){u.output=u.output.slice(0,-(l.output+i.output).length),l.output=`(?:${l.output}`,i.type="globstar",i.output=N(t)+(t.strictSlashes?")":"|$)"),i.value+=a,u.globstar=!0,u.output+=l.output+i.output,X(a);continue}if(l.type==="slash"&&l.prev.type!=="bos"&&f[0]==="/"){let Ce=f[1]!==void 0?"|$":"";u.output=u.output.slice(0,-(l.output+i.output).length),l.output=`(?:${l.output}`,i.type="globstar",i.output=`${N(t)}${I}|${I}${Ce})`,i.value+=a,u.output+=l.output+i.output,u.globstar=!0,X(a+x()),b({type:"slash",value:"/",output:""});continue}if(l.type==="bos"&&f[0]==="/"){i.type="globstar",i.value+=a,i.output=`(?:^|${I}|${N(t)}${I})`,u.output=i.output,u.globstar=!0,X(a+x()),b({type:"slash",value:"/",output:""});continue}u.output=u.output.slice(0,-i.output.length),i.type="globstar",i.output=N(t),i.value+=a,u.output+=i.output,u.globstar=!0,X(a);continue}let E={type:"star",value:a,output:R};if(t.bash===!0){E.output=".*?",(i.type==="bos"||i.type==="slash")&&(E.output=U+E.output),b(E);continue}if(i&&(i.type==="bracket"||i.type==="paren")&&t.regex===!0){E.output=a,b(E);continue}(u.index===u.start||i.type==="slash"||i.type==="dot")&&(i.type==="dot"?(u.output+=se,i.output+=se):t.dot===!0?(u.output+=Z,i.output+=Z):(u.output+=U,i.output+=U),C()!=="*"&&(u.output+=F,i.output+=F)),b(E)}for(;u.brackets>0;){if(t.strictBrackets===!0)throw new SyntaxError(ge("closing","]"));u.output=ee.escapeLast(u.output,"["),ae("brackets")}for(;u.parens>0;){if(t.strictBrackets===!0)throw new SyntaxError(ge("closing",")"));u.output=ee.escapeLast(u.output,"("),ae("parens")}for(;u.braces>0;){if(t.strictBrackets===!0)throw new SyntaxError(ge("closing","}"));u.output=ee.escapeLast(u.output,"{"),ae("braces")}if(t.strictSlashes!==!0&&(i.type==="star"||i.type==="bracket")&&b({type:"maybe_slash",value:"",output:`${I}?`}),u.backtrack===!0){u.output="";for(let f of u.tokens)u.output+=f.output!=null?f.output:f.value,f.suffix&&(u.output+=f.suffix)}return u};Ue.fastpaths=(e,r)=>{let t={...r},o=typeof t.maxLength=="number"?Math.min(Le,t.maxLength):Le,n=e.length;if(n>o)throw new SyntaxError(`Input length: ${n}, exceeds maximum allowed length: ${o}`);e=_t[e]||e;let{DOT_LITERAL:s,SLASH_LITERAL:c,ONE_CHAR:p,DOTS_SLASH:g,NO_DOT:h,NO_DOTS:m,NO_DOTS_SLASH:$,STAR:I,START_ANCHOR:F}=Te.globChars(t.windows),y=t.dot?m:h,H=t.dot?$:h,se=t.capture?"":"?:",Z={negated:!1,prefix:""},_=t.bash===!0?".*?":I;t.capture&&(_=`(${_})`);let z=U=>U.noglobstar===!0?_:`(${se}(?:(?!${F}${U.dot?g:s}).)*?)`,ie=U=>{switch(U){case"*":return`${y}${p}${_}`;case".*":return`${s}${p}${_}`;case"*.*":return`${y}${_}${s}${p}${_}`;case"*/*":return`${y}${_}${c}${p}${H}${_}`;case"**":return y+z(t);case"**/*":return`(?:${y}${z(t)}${c})?${H}${p}${_}`;case"**/*.*":return`(?:${y}${z(t)}${c})?${H}${_}${s}${p}${_}`;case"**/.*":return`(?:${y}${z(t)}${c})?${s}${p}${_}`;default:{let d=/^(.*?)\.(\w+)$/.exec(U);if(!d)return;let R=ie(d[1]);return R?R+s+d[2]:void 0}}},D=ee.removePrefix(e,Z),N=ie(D);return N&&t.strictSlashes!==!0&&(N+=`${c}?`),N};Et.exports=Ue});var vt=ce((oo,St)=>{"use strict";var kr=Ct(),Ve=Ot(),xt=Re(),wr=Ae(),Hr=e=>e&&typeof e=="object"&&!Array.isArray(e),L=(e,r,t=!1)=>{if(Array.isArray(e)){let m=e.map(I=>L(I,r,t));return I=>{for(let F of m){let y=F(I);if(y)return y}return!1}}let o=Hr(e)&&e.tokens&&e.input;if(e===""||typeof e!="string"&&!o)throw new TypeError("Expected pattern to be a non-empty string");let n=r||{},s=n.windows,c=o?L.compileRe(e,r):L.makeRe(e,r,!1,!0),p=c.state;delete c.state;let g=()=>!1;if(n.ignore){let m={...r,ignore:null,onMatch:null,onResult:null};g=L(n.ignore,m,t)}let h=(m,$=!1)=>{let{isMatch:I,match:F,output:y}=L.test(m,c,r,{glob:e,posix:s}),H={glob:e,state:p,regex:c,posix:s,input:m,output:y,match:F,isMatch:I};return typeof n.onResult=="function"&&n.onResult(H),I===!1?(H.isMatch=!1,$?H:!1):g(m)?(typeof n.onIgnore=="function"&&n.onIgnore(H),H.isMatch=!1,$?H:!1):(typeof n.onMatch=="function"&&n.onMatch(H),$?H:!0)};return t&&(h.state=p),h};L.test=(e,r,t,{glob:o,posix:n}={})=>{if(typeof e!="string")throw new TypeError("Expected input to be a string");if(e==="")return{isMatch:!1,output:""};let s=t||{},c=s.format||(n?xt.toPosixSlashes:null),p=e===o,g=p&&c?c(e):e;return p===!1&&(g=c?c(e):e,p=g===o),(p===!1||s.capture===!0)&&(s.matchBase===!0||s.basename===!0?p=L.matchBase(e,r,t,n):p=r.exec(g)),{isMatch:!!p,match:p,output:g}};L.matchBase=(e,r,t)=>(r instanceof RegExp?r:L.makeRe(r,t)).test(xt.basename(e));L.isMatch=(e,r,t)=>L(r,t)(e);L.parse=(e,r)=>Array.isArray(e)?e.map(t=>L.parse(t,r)):Ve(e,{...r,fastpaths:!1});L.scan=(e,r)=>kr(e,r);L.compileRe=(e,r,t=!1,o=!1)=>{if(t===!0)return e.output;let n=r||{},s=n.contains?"":"^",c=n.contains?"":"$",p=`${s}(?:${e.output})${c}`;e&&e.negated===!0&&(p=`^(?!${p}).*$`);let g=L.toRegex(p,r);return o===!0&&(g.state=e),g};L.makeRe=(e,r={},t=!1,o=!1)=>{if(!e||typeof e!="string")throw new TypeError("Expected a non-empty string");let n={negated:!1,fastpaths:!0};return r.fastpaths!==!1&&(e[0]==="."||e[0]==="*")&&(n.output=Ve.fastpaths(e,r)),n.output||(n=Ve(e,r)),L.compileRe(n,r,t,o)};L.toRegex=(e,r)=>{try{let t=r||{};return new RegExp(e,t.flags||(t.nocase?"i":""))}catch(t){if(r&&r.debug===!0)throw t;return/$^/}};L.constants=wr;St.exports=L});var It=ce((no,$t)=>{"use strict";var Tt=vt(),Nr=Re();function Lt(e,r,t=!1){return r&&(r.windows===null||r.windows===void 0)&&(r={...r,windows:Nr.isWindows()}),Tt(e,r,t)}Object.assign(Lt,Tt);$t.exports=Lt});var Br={};Ft(Br,{default:()=>Mr});var W=ue("@yarnpkg/core");var ze=(e=0)=>r=>`\x1B[${r+e}m`,Je=(e=0)=>r=>`\x1B[${38+e};5;${r}m`,et=(e=0)=>(r,t,o)=>`\x1B[${38+e};2;${r};${t};${o}m`,O={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],gray:[90,39],grey:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgGray:[100,49],bgGrey:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}},Wr=Object.keys(O.modifier),Vt=Object.keys(O.color),Kt=Object.keys(O.bgColor),Fr=[...Vt,...Kt];function Xt(){let e=new Map;for(let[r,t]of Object.entries(O)){for(let[o,n]of Object.entries(t))O[o]={open:`\x1B[${n[0]}m`,close:`\x1B[${n[1]}m`},t[o]=O[o],e.set(n[0],n[1]);Object.defineProperty(O,r,{value:t,enumerable:!1})}return Object.defineProperty(O,"codes",{value:e,enumerable:!1}),O.color.close="\x1B[39m",O.bgColor.close="\x1B[49m",O.color.ansi=ze(),O.color.ansi256=Je(),O.color.ansi16m=et(),O.bgColor.ansi=ze(10),O.bgColor.ansi256=Je(10),O.bgColor.ansi16m=et(10),Object.defineProperties(O,{rgbToAnsi256:{value(r,t,o){return r===t&&t===o?r<8?16:r>248?231:Math.round((r-8)/247*24)+232:16+36*Math.round(r/255*5)+6*Math.round(t/255*5)+Math.round(o/255*5)},enumerable:!1},hexToRgb:{value(r){let t=/[a-f\d]{6}|[a-f\d]{3}/i.exec(r.toString(16));if(!t)return[0,0,0];let[o]=t;o.length===3&&(o=[...o].map(s=>s+s).join(""));let n=Number.parseInt(o,16);return[n>>16&255,n>>8&255,n&255]},enumerable:!1},hexToAnsi256:{value:r=>O.rgbToAnsi256(...O.hexToRgb(r)),enumerable:!1},ansi256ToAnsi:{value(r){if(r<8)return 30+r;if(r<16)return 90+(r-8);let t,o,n;if(r>=232)t=((r-232)*10+8)/255,o=t,n=t;else{r-=16;let p=r%36;t=Math.floor(r/36)/5,o=Math.floor(p/6)/5,n=p%6/5}let s=Math.max(t,o,n)*2;if(s===0)return 30;let c=30+(Math.round(n)<<2|Math.round(o)<<1|Math.round(t));return s===2&&(c+=60),c},enumerable:!1},rgbToAnsi:{value:(r,t,o)=>O.ansi256ToAnsi(O.rgbToAnsi256(r,t,o)),enumerable:!1},hexToAnsi:{value:r=>O.ansi256ToAnsi(O.hexToAnsi256(r)),enumerable:!1}}),O}var qt=Xt(),Y=qt;var xe=Ee(ue("process"),1),rt=Ee(ue("os"),1),we=Ee(ue("tty"),1);function q(e,r=globalThis.Deno?globalThis.Deno.args:xe.default.argv){let t=e.startsWith("-")?"":e.length===1?"-":"--",o=r.indexOf(t+e),n=r.indexOf("--");return o!==-1&&(n===-1||o<n)}var{env:v}=xe.default,Oe;q("no-color")||q("no-colors")||q("color=false")||q("color=never")?Oe=0:(q("color")||q("colors")||q("color=true")||q("color=always"))&&(Oe=1);function Yt(){if("FORCE_COLOR"in v)return v.FORCE_COLOR==="true"?1:v.FORCE_COLOR==="false"?0:v.FORCE_COLOR.length===0?1:Math.min(Number.parseInt(v.FORCE_COLOR,10),3)}function Qt(e){return e===0?!1:{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}function Zt(e,{streamIsTTY:r,sniffFlags:t=!0}={}){let o=Yt();o!==void 0&&(Oe=o);let n=t?Oe:o;if(n===0)return 0;if(t){if(q("color=16m")||q("color=full")||q("color=truecolor"))return 3;if(q("color=256"))return 2}if("TF_BUILD"in v&&"AGENT_NAME"in v)return 1;if(e&&!r&&n===void 0)return 0;let s=n||0;if(v.TERM==="dumb")return s;if(xe.default.platform==="win32"){let c=rt.default.release().split(".");return Number(c[0])>=10&&Number(c[2])>=10586?Number(c[2])>=14931?3:2:1}if("CI"in v)return["GITHUB_ACTIONS","GITEA_ACTIONS","CIRCLECI"].some(c=>c in v)?3:["TRAVIS","APPVEYOR","GITLAB_CI","BUILDKITE","DRONE"].some(c=>c in v)||v.CI_NAME==="codeship"?1:s;if("TEAMCITY_VERSION"in v)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(v.TEAMCITY_VERSION)?1:0;if(v.COLORTERM==="truecolor"||v.TERM==="xterm-kitty")return 3;if("TERM_PROGRAM"in v){let c=Number.parseInt((v.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(v.TERM_PROGRAM){case"iTerm.app":return c>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(v.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(v.TERM)||"COLORTERM"in v?1:s}function tt(e,r={}){let t=Zt(e,{streamIsTTY:e&&e.isTTY,...r});return Qt(t)}var zt={stdout:tt({isTTY:we.default.isatty(1)}),stderr:tt({isTTY:we.default.isatty(2)})},ot=zt;function nt(e,r,t){let o=e.indexOf(r);if(o===-1)return e;let n=r.length,s=0,c="";do c+=e.slice(s,o)+r+t,s=o+n,o=e.indexOf(r,s);while(o!==-1);return c+=e.slice(s),c}function st(e,r,t,o){let n=0,s="";do{let c=e[o-1]==="\r";s+=e.slice(n,c?o-1:o)+r+(c?`\r
`:`
`)+t,n=o+1,o=e.indexOf(`
`,n)}while(o!==-1);return s+=e.slice(n),s}var{stdout:it,stderr:at}=ot,He=Symbol("GENERATOR"),le=Symbol("STYLER"),de=Symbol("IS_EMPTY"),ut=["ansi","ansi","ansi256","ansi16m"],fe=Object.create(null),Jt=(e,r={})=>{if(r.level&&!(Number.isInteger(r.level)&&r.level>=0&&r.level<=3))throw new Error("The `level` option should be an integer from 0 to 3");let t=it?it.level:0;e.level=r.level===void 0?t:r.level};var er=e=>{let r=(...t)=>t.join(" ");return Jt(r,e),Object.setPrototypeOf(r,he.prototype),r};function he(e){return er(e)}Object.setPrototypeOf(he.prototype,Function.prototype);for(let[e,r]of Object.entries(Y))fe[e]={get(){let t=Se(this,De(r.open,r.close,this[le]),this[de]);return Object.defineProperty(this,e,{value:t}),t}};fe.visible={get(){let e=Se(this,this[le],!0);return Object.defineProperty(this,"visible",{value:e}),e}};var Ne=(e,r,t,...o)=>e==="rgb"?r==="ansi16m"?Y[t].ansi16m(...o):r==="ansi256"?Y[t].ansi256(Y.rgbToAnsi256(...o)):Y[t].ansi(Y.rgbToAnsi(...o)):e==="hex"?Ne("rgb",r,t,...Y.hexToRgb(...o)):Y[t][e](...o),tr=["rgb","hex","ansi256"];for(let e of tr){fe[e]={get(){let{level:t}=this;return function(...o){let n=De(Ne(e,ut[t],"color",...o),Y.color.close,this[le]);return Se(this,n,this[de])}}};let r="bg"+e[0].toUpperCase()+e.slice(1);fe[r]={get(){let{level:t}=this;return function(...o){let n=De(Ne(e,ut[t],"bgColor",...o),Y.bgColor.close,this[le]);return Se(this,n,this[de])}}}}var rr=Object.defineProperties(()=>{},{...fe,level:{enumerable:!0,get(){return this[He].level},set(e){this[He].level=e}}}),De=(e,r,t)=>{let o,n;return t===void 0?(o=e,n=r):(o=t.openAll+e,n=r+t.closeAll),{open:e,close:r,openAll:o,closeAll:n,parent:t}},Se=(e,r,t)=>{let o=(...n)=>or(o,n.length===1?""+n[0]:n.join(" "));return Object.setPrototypeOf(o,rr),o[He]=e,o[le]=r,o[de]=t,o},or=(e,r)=>{if(e.level<=0||!r)return e[de]?"":r;let t=e[le];if(t===void 0)return r;let{openAll:o,closeAll:n}=t;if(r.includes("\x1B"))for(;t!==void 0;)r=nt(r,t.close,t.open),t=t.parent;let s=r.indexOf(`
`);return s!==-1&&(r=st(r,n,o,s)),o+r+n};Object.defineProperties(he.prototype,fe);var nr=he(),Qr=he({level:at?at.level:0});var pe=nr;var P=class extends Error{constructor(t,o){super(t);this.code=o;this.name="CatalogConfigurationError"}static{this.FILE_NOT_FOUND="FILE_NOT_FOUND"}static{this.INVALID_FORMAT="INVALID_FORMAT"}static{this.INVALID_ALIAS="INVALID_ALIAS"}};var kt=ue("@yarnpkg/core"),wt=Ee(It());var Q="root",j="catalog:";function ne(e){let r=e.split("/"),t=[];for(let o=0;o<r.length;o++)t.push(r.slice(0,o+1).join("/"));return t}var $e=class{constructor(){this.configCache=new Map}async readConfiguration(r){let o=r.cwd,n=this.configCache.get(o);if(n)return n;let s=r.configuration.get("catalogs")||{},c=s;if(s.list?c.list=Object.entries(s.list).reduce((p,[g,h])=>(typeof h=="string"?p[Q]={...p[Q]||{},[g]:h}:p[g]=h,p),{}):c.list={},!this.isValidConfiguration(c))throw new P("Invalid catalogs configuration format. Expected structure: { options?: { default?: string[] | 'max', ignoredWorkspaces?: string[], validation?: 'off' | 'warn' | 'strict' | { [package: string]: 'off' | 'warn' | 'strict' } }, list: { [alias: string]: { [packageName: string]: string } } }",P.INVALID_FORMAT);if(!this.validateInheritanceStructure(c))throw new P("Invalid inheritance structure in catalogs configuration. Check for missing parent groups.",P.INVALID_ALIAS);return this.configCache.set(o,c),c}clearCache(r){let t=r.cwd;this.configCache.delete(t)}validateInheritanceStructure(r){if(!r.list)return!0;let t=Object.keys(r.list);for(let o of t)if(typeof r.list[o]!="string"&&o.includes("/")){let n=ne(o);for(let s=0;s<n.length-1;s++){let c=n[s];if(!t.includes(c)&&c!==Q)return!1}}return!0}isValidConfiguration(r){if(!r||typeof r!="object"||!("list"in r)||!r.list||typeof r.list!="object")return!1;for(let[t,o]of Object.entries(r.list)){if(!o||typeof o!="object")return!1;for(let n of Object.values(o))if(typeof n!="string")return!1}if("options"in r&&r.options&&typeof r.options=="object"){if("ignoredWorkspaces"in r.options&&r.options.ignoredWorkspaces&&(!Array.isArray(r.options.ignoredWorkspaces)||r.options.ignoredWorkspaces.length===0))return!1;if("default"in r.options&&r.options.default){if(Array.isArray(r.options.default)){if(r.options.default.length===0)return!1;let t=Object.keys(r.list||{});for(let o of r.options.default)if(o!=="root"&&!t.includes(o))if(o.includes("/")){let n=ne(o),s=!0;for(let c of n)if(c!=="root"&&!t.includes(c)){s=!1;break}if(!s)return!1}else return!1}else if(typeof r.options.default!="string"||r.options.default!=="max")return!1}if("validation"in r.options){let t=r.options.validation;if(typeof t=="string"){if(!["warn","strict","off"].includes(t))return!1}else if(typeof t=="object"&&t!==null)for(let[o,n]of Object.entries(t)){if(typeof n!="string"||!["warn","strict","off"].includes(n))return!1;let s=Object.keys(r.list||{});if(!s.includes(o)&&o!==Q)if(o.includes("/")){let c=ne(o),p=!0;for(let g of c)if(g!==Q&&!s.includes(g)){p=!1;break}if(!p)return!1}else return!1}else return!1}}return!0}async shouldIgnoreWorkspace(r){if(!r.manifest.name)return!1;let t=await this.readConfiguration(r.project);return t.options?.ignoredWorkspaces?(0,wt.isMatch)(kt.structUtils.stringifyIdent(r.manifest.name),t.options.ignoredWorkspaces):!1}};var V=new $e;var Ie=ue("@yarnpkg/core");async function Ke(e,r,t){let o=await V.readConfiguration(e),n=r.length===0?Q:r,s=Ht(o,n,t);if(s)return/^[^:]+:/.test(s)?s:`${e.configuration.get("defaultProtocol")}${s}`;let c=o.list?.[n];if(!c||typeof c=="string")throw new P(`Alias "${n}" not found in .yarnrc.yml catalogs.`,P.INVALID_ALIAS);let p=c[t];if(!p)throw new P(`Package "${t}" not found in alias "${n}"`,P.INVALID_ALIAS);return/^[^:]+:/.test(p)?p:`${e.configuration.get("defaultProtocol")}${p}`}async function Xe(e,r){let t=await V.readConfiguration(e),o=[];for(let n of Object.keys(t.list||{})){let s=Ht(t,n,r);s&&o.push({groupName:n,version:s})}return o}function Ht(e,r,t){let o=ne(r);for(let s=o.length-1;s>=0;s--){let c=o[s],p=e.list?.[c];if(p&&typeof p=="object"){let g=p[t];if(g)return g}}if(e.list&&typeof e.list=="object"){let s=e.list[t];if(typeof s=="string")return s}let n=e.list?.[Q];if(n&&typeof n=="object"){let s=n[t];if(s)return s}return null}async function qe(e,r){if(r.range.startsWith(j)){if(await V.shouldIgnoreWorkspace(e))throw new Error(pe.red("The workspace is ignored from the catalogs, but the dependency to add is using the catalog protocol. Consider removing the protocol."));return}let t=await Qe(e,r);if(!t)return;let{validationLevel:o,applicableGroups:n}=t,s=await Ye(e);if(s.length>0){for(let h of s)if(n.includes(h)){r.range=`${j}${h}`;return}}let c=n.map(h=>h===Q?"":h),p=c.filter(h=>h!=="").length>0?` (${c.join(", ")})`:"",g=`\u27A4 ${r.name} is listed in the catalogs config${p}, but it seems you're adding it without the catalog protocol. Consider running 'yarn add ${r.name}@${j}${c[0]}' instead.`;if(o==="strict")throw new Error(pe.red(g));o==="warn"&&console.warn(pe.yellow(g))}async function Ye(e){let r=await V.readConfiguration(e.project);if(r.options){if(await V.shouldIgnoreWorkspace(e))return[];if(r.options.default){if(Array.isArray(r.options.default))return r.options.default;if(r.options.default==="max"){let t=Object.keys(r.list||{}),o=[...Object.entries(e.manifest.raw.dependencies??{}),...Object.entries(e.manifest.raw.devDependencies??{})],n=Object.fromEntries(t.map(c=>[c,0]));for(let[c,p]of o)if(p.startsWith(j)){let g=p.substring(j.length);n[g]=(n[g]||0)+1}let s=Math.max(...Object.values(n));return Object.keys(n).filter(c=>n[c]===s)}}}return[]}async function Qe(e,r){if(r.range.startsWith(j)||await V.shouldIgnoreWorkspace(e))return null;let t=await Ye(e),o=Ie.structUtils.stringifyIdent(r),s=(await Xe(e.project,o)).flatMap(({groupName:p})=>t.length===0||t.includes(p)?[p]:[]);return s.length===0?null:{validationLevel:await Gr(e,o),applicableGroups:s}}async function Nt(e){let r=[...Object.entries(e.manifest.raw.dependencies??{}),...Object.entries(e.manifest.raw.devDependencies??{})].map(([o,n])=>{let s=Ie.structUtils.parseIdent(o);return Ie.structUtils.makeDescriptor(s,n)}),t=[];for(let o of r){let n=await Qe(e,o);n&&n.validationLevel!=="off"&&t.push({descriptor:o,validationLevel:n.validationLevel,applicableGroups:n.applicableGroups})}return t}async function Dr(e,r){let o=(await V.readConfiguration(e.project)).options?.validation||"warn";if(typeof o=="string")return o;let n=ne(r);for(let s=n.length-1;s>=0;s--){let c=n[s];if(o[c]!==void 0)return o[c]}return"warn"}async function Gr(e,r){let t=(await Xe(e.project,r)).map(({groupName:n})=>n);if(t.length===0)return"off";let o=[];for(let n of t){let s=await Dr(e,n);o.push(s)}return o.includes("strict")?"strict":o.includes("warn")?"warn":"off"}var Pr={configuration:{catalogs:{description:"Define dependency version ranges as reusable constants across your project.",type:W.SettingsType.ANY,default:{}}},hooks:{validateWorkspace:async(e,r)=>{let t=await V.shouldIgnoreWorkspace(e);if(!t){let n=await Nt(e);if(n.length>0){let s=n.filter(g=>g.validationLevel==="strict"),c=n.filter(g=>g.validationLevel==="warn"),p=g=>`The following dependencies are listed in the catalogs but not using the catalog protocol: ${g.map(m=>pe.yellow(W.structUtils.stringifyDescriptor(m.descriptor))).join(", ")}. Consider using the catalog protocol instead.`;s.length>0&&r.reportError(W.MessageName.INVALID_MANIFEST,p(s)),c.length>0&&r.reportWarning(W.MessageName.INVALID_MANIFEST,p(c))}}let o=[...Object.values(e.manifest.raw.dependencies||{}),...Object.values(e.manifest.raw.devDependencies||{})].some(n=>n.startsWith(j));t&&o&&r.reportError(W.MessageName.INVALID_MANIFEST,"Workspace is ignored from the catalogs, but it has dependencies with the catalog protocol. Consider removing the protocol.")},reduceDependency:async(e,r,...t)=>{let o=e.range.startsWith(j),n=e.range.includes("catalog%3A")&&e.range.startsWith("patch:");if(!o&&!n)return e;try{let s="",c=e.range;if(o)s=e.range.slice(j.length);else if(n){let $=e.range.match(/catalog%3A([^#&]*)/);$&&(s=$[1]||"")}let p=W.structUtils.stringifyIdent(e),g=await Ke(r,s,p),h;if(o?h=W.structUtils.makeDescriptor(W.structUtils.makeIdent(e.scope,e.name),g):h=W.structUtils.makeDescriptor(W.structUtils.makeIdent(e.scope,e.name),c.replace(/catalog%3A[^#&]*/,g)),n)return h;let m=await r.configuration.reduceHook($=>$.reduceDependency,h,r,...t);return m!==h?m:h}catch(s){throw s instanceof P?new Error(`Failed to resolve ${W.structUtils.stringifyDescriptor(e)}: ${s.message}`):s}},afterWorkspaceDependencyAddition:async(e,r,t)=>{qe(e,t)},afterWorkspaceDependencyReplacement:async(e,r,t,o)=>{qe(e,o)},beforeWorkspacePacking:async(e,r)=>{if(await V.shouldIgnoreWorkspace(e))return;let t=["dependencies","devDependencies","peerDependencies","optionalDependencies"];for(let o of t){let n=r[o];if(!(!n||typeof n!="object"))for(let[s,c]of Object.entries(n)){let p=c;if(p.startsWith(j))try{let g=p.slice(j.length),h=await Ke(e.project,g,s);n[s]=h}catch(g){throw g instanceof P?new Error(`Failed to resolve catalog dependency ${s}@${p} during packaging: ${g.message}`):g}}}}}},Mr=Pr;return Ut(Br);})();
return plugin;
}
};
