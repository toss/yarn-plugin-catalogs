/* eslint-disable */
//prettier-ignore
module.exports = {
name: "@yarnpkg/plugin-catalogs",
factory: function (require) {
"use strict";var plugin=(()=>{var We=Object.create;var _t=Object.defineProperty;var Ue=Object.getOwnPropertyDescriptor;var Ve=Object.getOwnPropertyNames;var Ke=Object.getPrototypeOf,Ye=Object.prototype.hasOwnProperty;var F=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(o,t)=>(typeof require<"u"?require:o)[t]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var st=(e,o)=>()=>(o||e((o={exports:{}}).exports,o),o.exports),Xe=(e,o)=>{for(var t in o)_t(e,t,{get:o[t],enumerable:!0})},te=(e,o,t,r)=>{if(o&&typeof o=="object"||typeof o=="function")for(let n of Ve(o))!Ye.call(e,n)&&n!==t&&_t(e,n,{get:()=>o[n],enumerable:!(r=Ue(o,n))||r.enumerable});return e};var Et=(e,o,t)=>(t=e!=null?We(Ke(e)):{},te(o||!e||!e.__esModule?_t(t,"default",{value:e,enumerable:!0}):t,e)),qe=e=>te(_t({},"__esModule",{value:!0}),e);var ht=st((rr,Ae)=>{"use strict";var Q="\\\\/",fe=`[^${Q}]`,J="\\.",uo="\\+",po="\\?",vt="\\/",fo="(?=.)",ge="[^/]",Wt=`(?:${vt}|$)`,he=`(?:^|${vt})`,Ut=`${J}{1,2}${Wt}`,go=`(?!${J})`,ho=`(?!${he}${Ut})`,Ao=`(?!${J}{0,1}${Wt})`,mo=`(?!${Ut})`,Ro=`[^.${vt}]`,yo=`${ge}*?`,bo="/",de={DOT_LITERAL:J,PLUS_LITERAL:uo,QMARK_LITERAL:po,SLASH_LITERAL:vt,ONE_CHAR:fo,QMARK:ge,END_ANCHOR:Wt,DOTS_SLASH:Ut,NO_DOT:go,NO_DOTS:ho,NO_DOT_SLASH:Ao,NO_DOTS_SLASH:mo,QMARK_NO_DOT:Ro,STAR:yo,START_ANCHOR:he,SEP:bo},Co={...de,SLASH_LITERAL:`[${Q}]`,QMARK:fe,STAR:`${fe}*?`,DOTS_SLASH:`${J}{1,2}(?:[${Q}]|$)`,NO_DOT:`(?!${J})`,NO_DOTS:`(?!(?:^|[${Q}])${J}{1,2}(?:[${Q}]|$))`,NO_DOT_SLASH:`(?!${J}{0,1}(?:[${Q}]|$))`,NO_DOTS_SLASH:`(?!${J}{1,2}(?:[${Q}]|$))`,QMARK_NO_DOT:`[^.${Q}]`,START_ANCHOR:`(?:^|[${Q}])`,END_ANCHOR:`(?:[${Q}]|$)`,SEP:"\\"},_o={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};Ae.exports={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:_o,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{__proto__:null,"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,extglobChars(e){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${e.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(e){return e===!0?Co:de}}});var dt=st(D=>{"use strict";var{REGEX_BACKSLASH:Eo,REGEX_REMOVE_BACKSLASH:xo,REGEX_SPECIAL_CHARS:Oo,REGEX_SPECIAL_CHARS_GLOBAL:So}=ht();D.isObject=e=>e!==null&&typeof e=="object"&&!Array.isArray(e);D.hasRegexChars=e=>Oo.test(e);D.isRegexChar=e=>e.length===1&&D.hasRegexChars(e);D.escapeRegex=e=>e.replace(So,"\\$1");D.toPosixSlashes=e=>e.replace(Eo,"/");D.isWindows=()=>{if(typeof navigator<"u"&&navigator.platform){let e=navigator.platform.toLowerCase();return e==="win32"||e==="windows"}return typeof process<"u"&&process.platform?process.platform==="win32":!1};D.removeBackslashes=e=>e.replace(xo,o=>o==="\\"?"":o);D.escapeLast=(e,o,t)=>{let r=e.lastIndexOf(o,t);return r===-1?e:e[r-1]==="\\"?D.escapeLast(e,o,r-1):`${e.slice(0,r)}\\${e.slice(r)}`};D.removePrefix=(e,o={})=>{let t=e;return t.startsWith("./")&&(t=t.slice(2),o.prefix="./"),t};D.wrapOutput=(e,o={},t={})=>{let r=t.contains?"":"^",n=t.contains?"":"$",l=`${r}(?:${e})${n}`;return o.negated===!0&&(l=`(?:^(?!${l}).*$)`),l};D.basename=(e,{windows:o}={})=>{let t=e.split(o?/[\\/]/:"/"),r=t[t.length-1];return r===""?t[t.length-2]:r}});var xe=st((sr,Ee)=>{"use strict";var me=dt(),{CHAR_ASTERISK:Vt,CHAR_AT:vo,CHAR_BACKWARD_SLASH:At,CHAR_COMMA:To,CHAR_DOT:Kt,CHAR_EXCLAMATION_MARK:Yt,CHAR_FORWARD_SLASH:_e,CHAR_LEFT_CURLY_BRACE:Xt,CHAR_LEFT_PARENTHESES:qt,CHAR_LEFT_SQUARE_BRACKET:$o,CHAR_PLUS:Lo,CHAR_QUESTION_MARK:Re,CHAR_RIGHT_CURLY_BRACE:wo,CHAR_RIGHT_PARENTHESES:ye,CHAR_RIGHT_SQUARE_BRACKET:ko}=ht(),be=e=>e===_e||e===At,Ce=e=>{e.isPrefix!==!0&&(e.depth=e.isGlobstar?1/0:1)},No=(e,o)=>{let t=o||{},r=e.length-1,n=t.parts===!0||t.scanToEnd===!0,l=[],c=[],f=[],g=e,y=-1,h=0,E=0,C=!1,$=!1,b=!1,S=!1,Y=!1,X=!1,x=!1,q=!1,rt=!1,M=!1,P=0,j,d,m={value:"",depth:0,isGlob:!1},i=()=>y>=r,B=()=>g.charCodeAt(y+1),H=()=>(j=d,g.charCodeAt(++y));for(;y<r;){d=H();let _;if(d===At){x=m.backslashes=!0,d=H(),d===Xt&&(X=!0);continue}if(X===!0||d===Xt){for(P++;i()!==!0&&(d=H());){if(d===At){x=m.backslashes=!0,H();continue}if(d===Xt){P++;continue}if(X!==!0&&d===Kt&&(d=H())===Kt){if(C=m.isBrace=!0,b=m.isGlob=!0,M=!0,n===!0)continue;break}if(X!==!0&&d===To){if(C=m.isBrace=!0,b=m.isGlob=!0,M=!0,n===!0)continue;break}if(d===wo&&(P--,P===0)){X=!1,C=m.isBrace=!0,M=!0;break}}if(n===!0)continue;break}if(d===_e){if(l.push(y),c.push(m),m={value:"",depth:0,isGlob:!1},M===!0)continue;if(j===Kt&&y===h+1){h+=2;continue}E=y+1;continue}if(t.noext!==!0&&(d===Lo||d===vo||d===Vt||d===Re||d===Yt)===!0&&B()===qt){if(b=m.isGlob=!0,S=m.isExtglob=!0,M=!0,d===Yt&&y===h&&(rt=!0),n===!0){for(;i()!==!0&&(d=H());){if(d===At){x=m.backslashes=!0,d=H();continue}if(d===ye){b=m.isGlob=!0,M=!0;break}}continue}break}if(d===Vt){if(j===Vt&&(Y=m.isGlobstar=!0),b=m.isGlob=!0,M=!0,n===!0)continue;break}if(d===Re){if(b=m.isGlob=!0,M=!0,n===!0)continue;break}if(d===$o){for(;i()!==!0&&(_=H());){if(_===At){x=m.backslashes=!0,H();continue}if(_===ko){$=m.isBracket=!0,b=m.isGlob=!0,M=!0;break}}if(n===!0)continue;break}if(t.nonegate!==!0&&d===Yt&&y===h){q=m.negated=!0,h++;continue}if(t.noparen!==!0&&d===qt){if(b=m.isGlob=!0,n===!0){for(;i()!==!0&&(d=H());){if(d===qt){x=m.backslashes=!0,d=H();continue}if(d===ye){M=!0;break}}continue}break}if(b===!0){if(M=!0,n===!0)continue;break}}t.noext===!0&&(S=!1,b=!1);let k=g,s="",a="";h>0&&(s=g.slice(0,h),g=g.slice(h),E-=h),k&&b===!0&&E>0?(k=g.slice(0,E),a=g.slice(E)):b===!0?(k="",a=g):k=g,k&&k!==""&&k!=="/"&&k!==g&&be(k.charCodeAt(k.length-1))&&(k=k.slice(0,-1)),t.unescape===!0&&(a&&(a=me.removeBackslashes(a)),k&&x===!0&&(k=me.removeBackslashes(k)));let W={prefix:s,input:e,start:h,base:k,glob:a,isBrace:C,isBracket:$,isGlob:b,isExtglob:S,isGlobstar:Y,negated:q,negatedExtglob:rt};if(t.tokens===!0&&(W.maxDepth=0,be(d)||c.push(m),W.tokens=c),t.parts===!0||t.tokens===!0){let _;for(let L=0;L<l.length;L++){let Z=_?_+1:h,U=l[L],ot=e.slice(Z,U);t.tokens&&(L===0&&h!==0?(c[L].isPrefix=!0,c[L].value=s):c[L].value=ot,Ce(c[L]),W.maxDepth+=c[L].depth),(L!==0||ot!=="")&&f.push(ot),_=U}if(_&&_+1<e.length){let L=e.slice(_+1);f.push(L),t.tokens&&(c[c.length-1].value=L,Ce(c[c.length-1]),W.maxDepth+=c[c.length-1].depth)}W.slashes=l,W.parts=f}return W};Ee.exports=No});var ve=st((ar,Se)=>{"use strict";var Tt=ht(),z=dt(),{MAX_LENGTH:$t,POSIX_REGEX_SOURCE:Ho,REGEX_NON_SPECIAL_CHARS:Io,REGEX_SPECIAL_CHARS_BACKREF:Po,REPLACEMENTS:Oe}=Tt,Mo=(e,o)=>{if(typeof o.expandRange=="function")return o.expandRange(...e,o);e.sort();let t=`[${e.join("-")}]`;try{new RegExp(t)}catch{return e.map(n=>z.escapeRegex(n)).join("..")}return t},lt=(e,o)=>`Missing ${e}: "${o}" - use "\\\\${o}" to match literal characters`,Qt=(e,o)=>{if(typeof e!="string")throw new TypeError("Expected a string");e=Oe[e]||e;let t={...o},r=typeof t.maxLength=="number"?Math.min($t,t.maxLength):$t,n=e.length;if(n>r)throw new SyntaxError(`Input length: ${n}, exceeds maximum allowed length: ${r}`);let l={type:"bos",value:"",output:t.prepend||""},c=[l],f=t.capture?"":"?:",g=Tt.globChars(t.windows),y=Tt.extglobChars(g),{DOT_LITERAL:h,PLUS_LITERAL:E,SLASH_LITERAL:C,ONE_CHAR:$,DOTS_SLASH:b,NO_DOT:S,NO_DOT_SLASH:Y,NO_DOTS_SLASH:X,QMARK:x,QMARK_NO_DOT:q,STAR:rt,START_ANCHOR:M}=g,P=p=>`(${f}(?:(?!${M}${p.dot?b:h}).)*?)`,j=t.dot?"":S,d=t.dot?x:q,m=t.bash===!0?P(t):rt;t.capture&&(m=`(${m})`),typeof t.noext=="boolean"&&(t.noextglob=t.noext);let i={input:e,index:-1,start:0,dot:t.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:c};e=z.removePrefix(e,i),n=e.length;let B=[],H=[],k=[],s=l,a,W=()=>i.index===n-1,_=i.peek=(p=1)=>e[i.index+p],L=i.advance=()=>e[++i.index]||"",Z=()=>e.slice(i.index+1),U=(p="",O=0)=>{i.consumed+=p,i.index+=O},ot=p=>{i.output+=p.output!=null?p.output:p.value,U(p.value)},je=()=>{let p=1;for(;_()==="!"&&(_(2)!=="("||_(3)==="?");)L(),i.start++,p++;return p%2===0?!1:(i.negated=!0,i.start++,!0)},yt=p=>{i[p]++,k.push(p)},nt=p=>{i[p]--,k.pop()},R=p=>{if(s.type==="globstar"){let O=i.braces>0&&(p.type==="comma"||p.type==="brace"),u=p.extglob===!0||B.length&&(p.type==="pipe"||p.type==="paren");p.type!=="slash"&&p.type!=="paren"&&!O&&!u&&(i.output=i.output.slice(0,-s.output.length),s.type="star",s.value="*",s.output=m,i.output+=s.output)}if(B.length&&p.type!=="paren"&&(B[B.length-1].inner+=p.value),(p.value||p.output)&&ot(p),s&&s.type==="text"&&p.type==="text"){s.output=(s.output||s.value)+p.value,s.value+=p.value;return}p.prev=s,c.push(p),s=p},bt=(p,O)=>{let u={...y[O],conditions:1,inner:""};u.prev=s,u.parens=i.parens,u.output=i.output;let A=(t.capture?"(":"")+u.open;yt("parens"),R({type:p,value:O,output:i.output?"":$}),R({type:"paren",extglob:!0,value:L(),output:A}),B.push(u)},Fe=p=>{let O=p.close+(t.capture?")":""),u;if(p.type==="negate"){let A=m;if(p.inner&&p.inner.length>1&&p.inner.includes("/")&&(A=P(t)),(A!==m||W()||/^\)+$/.test(Z()))&&(O=p.close=`)$))${A}`),p.inner.includes("*")&&(u=Z())&&/^\.[^\\/.]+$/.test(u)){let w=Qt(u,{...o,fastpaths:!1}).output;O=p.close=`)${w})${A})`}p.prev.type==="bos"&&(i.negatedExtglob=!0)}R({type:"paren",extglob:!0,value:a,output:O}),nt("parens")};if(t.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(e)){let p=!1,O=e.replace(Po,(u,A,w,G,I,Gt)=>G==="\\"?(p=!0,u):G==="?"?A?A+G+(I?x.repeat(I.length):""):Gt===0?d+(I?x.repeat(I.length):""):x.repeat(w.length):G==="."?h.repeat(w.length):G==="*"?A?A+G+(I?m:""):m:A?u:`\\${u}`);return p===!0&&(t.unescape===!0?O=O.replace(/\\/g,""):O=O.replace(/\\+/g,u=>u.length%2===0?"\\\\":u?"\\":"")),O===e&&t.contains===!0?(i.output=e,i):(i.output=z.wrapOutput(O,i,o),i)}for(;!W();){if(a=L(),a==="\0")continue;if(a==="\\"){let u=_();if(u==="/"&&t.bash!==!0||u==="."||u===";")continue;if(!u){a+="\\",R({type:"text",value:a});continue}let A=/^\\+/.exec(Z()),w=0;if(A&&A[0].length>2&&(w=A[0].length,i.index+=w,w%2!==0&&(a+="\\")),t.unescape===!0?a=L():a+=L(),i.brackets===0){R({type:"text",value:a});continue}}if(i.brackets>0&&(a!=="]"||s.value==="["||s.value==="[^")){if(t.posix!==!1&&a===":"){let u=s.value.slice(1);if(u.includes("[")&&(s.posix=!0,u.includes(":"))){let A=s.value.lastIndexOf("["),w=s.value.slice(0,A),G=s.value.slice(A+2),I=Ho[G];if(I){s.value=w+I,i.backtrack=!0,L(),!l.output&&c.indexOf(s)===1&&(l.output=$);continue}}}(a==="["&&_()!==":"||a==="-"&&_()==="]")&&(a=`\\${a}`),a==="]"&&(s.value==="["||s.value==="[^")&&(a=`\\${a}`),t.posix===!0&&a==="!"&&s.value==="["&&(a="^"),s.value+=a,ot({value:a});continue}if(i.quotes===1&&a!=='"'){a=z.escapeRegex(a),s.value+=a,ot({value:a});continue}if(a==='"'){i.quotes=i.quotes===1?0:1,t.keepQuotes===!0&&R({type:"text",value:a});continue}if(a==="("){yt("parens"),R({type:"paren",value:a});continue}if(a===")"){if(i.parens===0&&t.strictBrackets===!0)throw new SyntaxError(lt("opening","("));let u=B[B.length-1];if(u&&i.parens===u.parens+1){Fe(B.pop());continue}R({type:"paren",value:a,output:i.parens?")":"\\)"}),nt("parens");continue}if(a==="["){if(t.nobracket===!0||!Z().includes("]")){if(t.nobracket!==!0&&t.strictBrackets===!0)throw new SyntaxError(lt("closing","]"));a=`\\${a}`}else yt("brackets");R({type:"bracket",value:a});continue}if(a==="]"){if(t.nobracket===!0||s&&s.type==="bracket"&&s.value.length===1){R({type:"text",value:a,output:`\\${a}`});continue}if(i.brackets===0){if(t.strictBrackets===!0)throw new SyntaxError(lt("opening","["));R({type:"text",value:a,output:`\\${a}`});continue}nt("brackets");let u=s.value.slice(1);if(s.posix!==!0&&u[0]==="^"&&!u.includes("/")&&(a=`/${a}`),s.value+=a,ot({value:a}),t.literalBrackets===!1||z.hasRegexChars(u))continue;let A=z.escapeRegex(s.value);if(i.output=i.output.slice(0,-s.value.length),t.literalBrackets===!0){i.output+=A,s.value=A;continue}s.value=`(${f}${A}|${s.value})`,i.output+=s.value;continue}if(a==="{"&&t.nobrace!==!0){yt("braces");let u={type:"brace",value:a,output:"(",outputIndex:i.output.length,tokensIndex:i.tokens.length};H.push(u),R(u);continue}if(a==="}"){let u=H[H.length-1];if(t.nobrace===!0||!u){R({type:"text",value:a,output:a});continue}let A=")";if(u.dots===!0){let w=c.slice(),G=[];for(let I=w.length-1;I>=0&&(c.pop(),w[I].type!=="brace");I--)w[I].type!=="dots"&&G.unshift(w[I].value);A=Mo(G,t),i.backtrack=!0}if(u.comma!==!0&&u.dots!==!0){let w=i.output.slice(0,u.outputIndex),G=i.tokens.slice(u.tokensIndex);u.value=u.output="\\{",a=A="\\}",i.output=w;for(let I of G)i.output+=I.output||I.value}R({type:"brace",value:a,output:A}),nt("braces"),H.pop();continue}if(a==="|"){B.length>0&&B[B.length-1].conditions++,R({type:"text",value:a});continue}if(a===","){let u=a,A=H[H.length-1];A&&k[k.length-1]==="braces"&&(A.comma=!0,u="|"),R({type:"comma",value:a,output:u});continue}if(a==="/"){if(s.type==="dot"&&i.index===i.start+1){i.start=i.index+1,i.consumed="",i.output="",c.pop(),s=l;continue}R({type:"slash",value:a,output:C});continue}if(a==="."){if(i.braces>0&&s.type==="dot"){s.value==="."&&(s.output=h);let u=H[H.length-1];s.type="dots",s.output+=a,s.value+=a,u.dots=!0;continue}if(i.braces+i.parens===0&&s.type!=="bos"&&s.type!=="slash"){R({type:"text",value:a,output:h});continue}R({type:"dot",value:a,output:h});continue}if(a==="?"){if(!(s&&s.value==="(")&&t.noextglob!==!0&&_()==="("&&_(2)!=="?"){bt("qmark",a);continue}if(s&&s.type==="paren"){let A=_(),w=a;(s.value==="("&&!/[!=<:]/.test(A)||A==="<"&&!/<([!=]|\w+>)/.test(Z()))&&(w=`\\${a}`),R({type:"text",value:a,output:w});continue}if(t.dot!==!0&&(s.type==="slash"||s.type==="bos")){R({type:"qmark",value:a,output:q});continue}R({type:"qmark",value:a,output:x});continue}if(a==="!"){if(t.noextglob!==!0&&_()==="("&&(_(2)!=="?"||!/[!=<:]/.test(_(3)))){bt("negate",a);continue}if(t.nonegate!==!0&&i.index===0){je();continue}}if(a==="+"){if(t.noextglob!==!0&&_()==="("&&_(2)!=="?"){bt("plus",a);continue}if(s&&s.value==="("||t.regex===!1){R({type:"plus",value:a,output:E});continue}if(s&&(s.type==="bracket"||s.type==="paren"||s.type==="brace")||i.parens>0){R({type:"plus",value:a});continue}R({type:"plus",value:E});continue}if(a==="@"){if(t.noextglob!==!0&&_()==="("&&_(2)!=="?"){R({type:"at",extglob:!0,value:a,output:""});continue}R({type:"text",value:a});continue}if(a!=="*"){(a==="$"||a==="^")&&(a=`\\${a}`);let u=Io.exec(Z());u&&(a+=u[0],i.index+=u[0].length),R({type:"text",value:a});continue}if(s&&(s.type==="globstar"||s.star===!0)){s.type="star",s.star=!0,s.value+=a,s.output=m,i.backtrack=!0,i.globstar=!0,U(a);continue}let p=Z();if(t.noextglob!==!0&&/^\([^?]/.test(p)){bt("star",a);continue}if(s.type==="star"){if(t.noglobstar===!0){U(a);continue}let u=s.prev,A=u.prev,w=u.type==="slash"||u.type==="bos",G=A&&(A.type==="star"||A.type==="globstar");if(t.bash===!0&&(!w||p[0]&&p[0]!=="/")){R({type:"star",value:a,output:""});continue}let I=i.braces>0&&(u.type==="comma"||u.type==="brace"),Gt=B.length&&(u.type==="pipe"||u.type==="paren");if(!w&&u.type!=="paren"&&!I&&!Gt){R({type:"star",value:a,output:""});continue}for(;p.slice(0,3)==="/**";){let Ct=e[i.index+4];if(Ct&&Ct!=="/")break;p=p.slice(3),U("/**",3)}if(u.type==="bos"&&W()){s.type="globstar",s.value+=a,s.output=P(t),i.output=s.output,i.globstar=!0,U(a);continue}if(u.type==="slash"&&u.prev.type!=="bos"&&!G&&W()){i.output=i.output.slice(0,-(u.output+s.output).length),u.output=`(?:${u.output}`,s.type="globstar",s.output=P(t)+(t.strictSlashes?")":"|$)"),s.value+=a,i.globstar=!0,i.output+=u.output+s.output,U(a);continue}if(u.type==="slash"&&u.prev.type!=="bos"&&p[0]==="/"){let Ct=p[1]!==void 0?"|$":"";i.output=i.output.slice(0,-(u.output+s.output).length),u.output=`(?:${u.output}`,s.type="globstar",s.output=`${P(t)}${C}|${C}${Ct})`,s.value+=a,i.output+=u.output+s.output,i.globstar=!0,U(a+L()),R({type:"slash",value:"/",output:""});continue}if(u.type==="bos"&&p[0]==="/"){s.type="globstar",s.value+=a,s.output=`(?:^|${C}|${P(t)}${C})`,i.output=s.output,i.globstar=!0,U(a+L()),R({type:"slash",value:"/",output:""});continue}i.output=i.output.slice(0,-s.output.length),s.type="globstar",s.output=P(t),s.value+=a,i.output+=s.output,i.globstar=!0,U(a);continue}let O={type:"star",value:a,output:m};if(t.bash===!0){O.output=".*?",(s.type==="bos"||s.type==="slash")&&(O.output=j+O.output),R(O);continue}if(s&&(s.type==="bracket"||s.type==="paren")&&t.regex===!0){O.output=a,R(O);continue}(i.index===i.start||s.type==="slash"||s.type==="dot")&&(s.type==="dot"?(i.output+=Y,s.output+=Y):t.dot===!0?(i.output+=X,s.output+=X):(i.output+=j,s.output+=j),_()!=="*"&&(i.output+=$,s.output+=$)),R(O)}for(;i.brackets>0;){if(t.strictBrackets===!0)throw new SyntaxError(lt("closing","]"));i.output=z.escapeLast(i.output,"["),nt("brackets")}for(;i.parens>0;){if(t.strictBrackets===!0)throw new SyntaxError(lt("closing",")"));i.output=z.escapeLast(i.output,"("),nt("parens")}for(;i.braces>0;){if(t.strictBrackets===!0)throw new SyntaxError(lt("closing","}"));i.output=z.escapeLast(i.output,"{"),nt("braces")}if(t.strictSlashes!==!0&&(s.type==="star"||s.type==="bracket")&&R({type:"maybe_slash",value:"",output:`${C}?`}),i.backtrack===!0){i.output="";for(let p of i.tokens)i.output+=p.output!=null?p.output:p.value,p.suffix&&(i.output+=p.suffix)}return i};Qt.fastpaths=(e,o)=>{let t={...o},r=typeof t.maxLength=="number"?Math.min($t,t.maxLength):$t,n=e.length;if(n>r)throw new SyntaxError(`Input length: ${n}, exceeds maximum allowed length: ${r}`);e=Oe[e]||e;let{DOT_LITERAL:l,SLASH_LITERAL:c,ONE_CHAR:f,DOTS_SLASH:g,NO_DOT:y,NO_DOTS:h,NO_DOTS_SLASH:E,STAR:C,START_ANCHOR:$}=Tt.globChars(t.windows),b=t.dot?h:y,S=t.dot?E:y,Y=t.capture?"":"?:",X={negated:!1,prefix:""},x=t.bash===!0?".*?":C;t.capture&&(x=`(${x})`);let q=j=>j.noglobstar===!0?x:`(${Y}(?:(?!${$}${j.dot?g:l}).)*?)`,rt=j=>{switch(j){case"*":return`${b}${f}${x}`;case".*":return`${l}${f}${x}`;case"*.*":return`${b}${x}${l}${f}${x}`;case"*/*":return`${b}${x}${c}${f}${S}${x}`;case"**":return b+q(t);case"**/*":return`(?:${b}${q(t)}${c})?${S}${f}${x}`;case"**/*.*":return`(?:${b}${q(t)}${c})?${S}${x}${l}${f}${x}`;case"**/.*":return`(?:${b}${q(t)}${c})?${l}${f}${x}`;default:{let d=/^(.*?)\.(\w+)$/.exec(j);if(!d)return;let m=rt(d[1]);return m?m+l+d[2]:void 0}}},M=z.removePrefix(e,X),P=rt(M);return P&&t.strictSlashes!==!0&&(P+=`${c}?`),P};Se.exports=Qt});var Le=st((ir,$e)=>{"use strict";var Go=xe(),zt=ve(),Te=dt(),Bo=ht(),Do=e=>e&&typeof e=="object"&&!Array.isArray(e),N=(e,o,t=!1)=>{if(Array.isArray(e)){let h=e.map(C=>N(C,o,t));return C=>{for(let $ of h){let b=$(C);if(b)return b}return!1}}let r=Do(e)&&e.tokens&&e.input;if(e===""||typeof e!="string"&&!r)throw new TypeError("Expected pattern to be a non-empty string");let n=o||{},l=n.windows,c=r?N.compileRe(e,o):N.makeRe(e,o,!1,!0),f=c.state;delete c.state;let g=()=>!1;if(n.ignore){let h={...o,ignore:null,onMatch:null,onResult:null};g=N(n.ignore,h,t)}let y=(h,E=!1)=>{let{isMatch:C,match:$,output:b}=N.test(h,c,o,{glob:e,posix:l}),S={glob:e,state:f,regex:c,posix:l,input:h,output:b,match:$,isMatch:C};return typeof n.onResult=="function"&&n.onResult(S),C===!1?(S.isMatch=!1,E?S:!1):g(h)?(typeof n.onIgnore=="function"&&n.onIgnore(S),S.isMatch=!1,E?S:!1):(typeof n.onMatch=="function"&&n.onMatch(S),E?S:!0)};return t&&(y.state=f),y};N.test=(e,o,t,{glob:r,posix:n}={})=>{if(typeof e!="string")throw new TypeError("Expected input to be a string");if(e==="")return{isMatch:!1,output:""};let l=t||{},c=l.format||(n?Te.toPosixSlashes:null),f=e===r,g=f&&c?c(e):e;return f===!1&&(g=c?c(e):e,f=g===r),(f===!1||l.capture===!0)&&(l.matchBase===!0||l.basename===!0?f=N.matchBase(e,o,t,n):f=o.exec(g)),{isMatch:!!f,match:f,output:g}};N.matchBase=(e,o,t)=>(o instanceof RegExp?o:N.makeRe(o,t)).test(Te.basename(e));N.isMatch=(e,o,t)=>N(o,t)(e);N.parse=(e,o)=>Array.isArray(e)?e.map(t=>N.parse(t,o)):zt(e,{...o,fastpaths:!1});N.scan=(e,o)=>Go(e,o);N.compileRe=(e,o,t=!1,r=!1)=>{if(t===!0)return e.output;let n=o||{},l=n.contains?"":"^",c=n.contains?"":"$",f=`${l}(?:${e.output})${c}`;e&&e.negated===!0&&(f=`^(?!${f}).*$`);let g=N.toRegex(f,o);return r===!0&&(g.state=e),g};N.makeRe=(e,o={},t=!1,r=!1)=>{if(!e||typeof e!="string")throw new TypeError("Expected a non-empty string");let n={negated:!1,fastpaths:!0};return o.fastpaths!==!1&&(e[0]==="."||e[0]==="*")&&(n.output=zt.fastpaths(e,o)),n.output||(n=zt(e,o)),N.compileRe(n,o,t,r)};N.toRegex=(e,o)=>{try{let t=o||{};return new RegExp(e,t.flags||(t.nocase?"i":""))}catch(t){if(o&&o.debug===!0)throw t;return/$^/}};N.constants=Bo;$e.exports=N});var He=st((cr,Ne)=>{"use strict";var we=Le(),jo=dt();function ke(e,o,t=!1){return o&&(o.windows===null||o.windows===void 0)&&(o={...o,windows:jo.isWindows()}),we(e,o,t)}Object.assign(ke,we);Ne.exports=ke});var Vo={};Xe(Vo,{default:()=>Uo});var Mt=F("@yarnpkg/core");var ee=(e=0)=>o=>`\x1B[${o+e}m`,oe=(e=0)=>o=>`\x1B[${38+e};5;${o}m`,re=(e=0)=>(o,t,r)=>`\x1B[${38+e};2;${o};${t};${r}m`,v={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],gray:[90,39],grey:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgGray:[100,49],bgGrey:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}},Yo=Object.keys(v.modifier),Qe=Object.keys(v.color),ze=Object.keys(v.bgColor),Xo=[...Qe,...ze];function Ze(){let e=new Map;for(let[o,t]of Object.entries(v)){for(let[r,n]of Object.entries(t))v[r]={open:`\x1B[${n[0]}m`,close:`\x1B[${n[1]}m`},t[r]=v[r],e.set(n[0],n[1]);Object.defineProperty(v,o,{value:t,enumerable:!1})}return Object.defineProperty(v,"codes",{value:e,enumerable:!1}),v.color.close="\x1B[39m",v.bgColor.close="\x1B[49m",v.color.ansi=ee(),v.color.ansi256=oe(),v.color.ansi16m=re(),v.bgColor.ansi=ee(10),v.bgColor.ansi256=oe(10),v.bgColor.ansi16m=re(10),Object.defineProperties(v,{rgbToAnsi256:{value(o,t,r){return o===t&&t===r?o<8?16:o>248?231:Math.round((o-8)/247*24)+232:16+36*Math.round(o/255*5)+6*Math.round(t/255*5)+Math.round(r/255*5)},enumerable:!1},hexToRgb:{value(o){let t=/[a-f\d]{6}|[a-f\d]{3}/i.exec(o.toString(16));if(!t)return[0,0,0];let[r]=t;r.length===3&&(r=[...r].map(l=>l+l).join(""));let n=Number.parseInt(r,16);return[n>>16&255,n>>8&255,n&255]},enumerable:!1},hexToAnsi256:{value:o=>v.rgbToAnsi256(...v.hexToRgb(o)),enumerable:!1},ansi256ToAnsi:{value(o){if(o<8)return 30+o;if(o<16)return 90+(o-8);let t,r,n;if(o>=232)t=((o-232)*10+8)/255,r=t,n=t;else{o-=16;let f=o%36;t=Math.floor(o/36)/5,r=Math.floor(f/6)/5,n=f%6/5}let l=Math.max(t,r,n)*2;if(l===0)return 30;let c=30+(Math.round(n)<<2|Math.round(r)<<1|Math.round(t));return l===2&&(c+=60),c},enumerable:!1},rgbToAnsi:{value:(o,t,r)=>v.ansi256ToAnsi(v.rgbToAnsi256(o,t,r)),enumerable:!1},hexToAnsi:{value:o=>v.ansi256ToAnsi(v.hexToAnsi256(o)),enumerable:!1}}),v}var Je=Ze(),K=Je;var Ot=Et(F("process"),1),se=Et(F("os"),1),Bt=Et(F("tty"),1);function V(e,o=globalThis.Deno?globalThis.Deno.args:Ot.default.argv){let t=e.startsWith("-")?"":e.length===1?"-":"--",r=o.indexOf(t+e),n=o.indexOf("--");return r!==-1&&(n===-1||r<n)}var{env:T}=Ot.default,xt;V("no-color")||V("no-colors")||V("color=false")||V("color=never")?xt=0:(V("color")||V("colors")||V("color=true")||V("color=always"))&&(xt=1);function to(){if("FORCE_COLOR"in T)return T.FORCE_COLOR==="true"?1:T.FORCE_COLOR==="false"?0:T.FORCE_COLOR.length===0?1:Math.min(Number.parseInt(T.FORCE_COLOR,10),3)}function eo(e){return e===0?!1:{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}function oo(e,{streamIsTTY:o,sniffFlags:t=!0}={}){let r=to();r!==void 0&&(xt=r);let n=t?xt:r;if(n===0)return 0;if(t){if(V("color=16m")||V("color=full")||V("color=truecolor"))return 3;if(V("color=256"))return 2}if("TF_BUILD"in T&&"AGENT_NAME"in T)return 1;if(e&&!o&&n===void 0)return 0;let l=n||0;if(T.TERM==="dumb")return l;if(Ot.default.platform==="win32"){let c=se.default.release().split(".");return Number(c[0])>=10&&Number(c[2])>=10586?Number(c[2])>=14931?3:2:1}if("CI"in T)return["GITHUB_ACTIONS","GITEA_ACTIONS","CIRCLECI"].some(c=>c in T)?3:["TRAVIS","APPVEYOR","GITLAB_CI","BUILDKITE","DRONE"].some(c=>c in T)||T.CI_NAME==="codeship"?1:l;if("TEAMCITY_VERSION"in T)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(T.TEAMCITY_VERSION)?1:0;if(T.COLORTERM==="truecolor"||T.TERM==="xterm-kitty"||T.TERM==="xterm-ghostty"||T.TERM==="wezterm")return 3;if("TERM_PROGRAM"in T){let c=Number.parseInt((T.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(T.TERM_PROGRAM){case"iTerm.app":return c>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(T.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(T.TERM)||"COLORTERM"in T?1:l}function ne(e,o={}){let t=oo(e,{streamIsTTY:e&&e.isTTY,...o});return eo(t)}var ro={stdout:ne({isTTY:Bt.default.isatty(1)}),stderr:ne({isTTY:Bt.default.isatty(2)})},ae=ro;function ie(e,o,t){let r=e.indexOf(o);if(r===-1)return e;let n=o.length,l=0,c="";do c+=e.slice(l,r)+o+t,l=r+n,r=e.indexOf(o,l);while(r!==-1);return c+=e.slice(l),c}function ce(e,o,t,r){let n=0,l="";do{let c=e[r-1]==="\r";l+=e.slice(n,c?r-1:r)+o+(c?`\r
`:`
`)+t,n=r+1,r=e.indexOf(`
`,n)}while(r!==-1);return l+=e.slice(n),l}var{stdout:le,stderr:ue}=ae,Dt=Symbol("GENERATOR"),at=Symbol("STYLER"),ft=Symbol("IS_EMPTY"),pe=["ansi","ansi","ansi256","ansi16m"],it=Object.create(null),no=(e,o={})=>{if(o.level&&!(Number.isInteger(o.level)&&o.level>=0&&o.level<=3))throw new Error("The `level` option should be an integer from 0 to 3");let t=le?le.level:0;e.level=o.level===void 0?t:o.level};var so=e=>{let o=(...t)=>t.join(" ");return no(o,e),Object.setPrototypeOf(o,gt.prototype),o};function gt(e){return so(e)}Object.setPrototypeOf(gt.prototype,Function.prototype);for(let[e,o]of Object.entries(K))it[e]={get(){let t=St(this,Ft(o.open,o.close,this[at]),this[ft]);return Object.defineProperty(this,e,{value:t}),t}};it.visible={get(){let e=St(this,this[at],!0);return Object.defineProperty(this,"visible",{value:e}),e}};var jt=(e,o,t,...r)=>e==="rgb"?o==="ansi16m"?K[t].ansi16m(...r):o==="ansi256"?K[t].ansi256(K.rgbToAnsi256(...r)):K[t].ansi(K.rgbToAnsi(...r)):e==="hex"?jt("rgb",o,t,...K.hexToRgb(...r)):K[t][e](...r),ao=["rgb","hex","ansi256"];for(let e of ao){it[e]={get(){let{level:t}=this;return function(...r){let n=Ft(jt(e,pe[t],"color",...r),K.color.close,this[at]);return St(this,n,this[ft])}}};let o="bg"+e[0].toUpperCase()+e.slice(1);it[o]={get(){let{level:t}=this;return function(...r){let n=Ft(jt(e,pe[t],"bgColor",...r),K.bgColor.close,this[at]);return St(this,n,this[ft])}}}}var io=Object.defineProperties(()=>{},{...it,level:{enumerable:!0,get(){return this[Dt].level},set(e){this[Dt].level=e}}}),Ft=(e,o,t)=>{let r,n;return t===void 0?(r=e,n=o):(r=t.openAll+e,n=o+t.closeAll),{open:e,close:o,openAll:r,closeAll:n,parent:t}},St=(e,o,t)=>{let r=(...n)=>co(r,n.length===1?""+n[0]:n.join(" "));return Object.setPrototypeOf(r,io),r[Dt]=e,r[at]=o,r[ft]=t,r},co=(e,o)=>{if(e.level<=0||!o)return e[ft]?"":o;let t=e[at];if(t===void 0)return o;let{openAll:r,closeAll:n}=t;if(o.includes("\x1B"))for(;t!==void 0;)o=ie(o,t.close,t.open),t=t.parent;let l=o.indexOf(`
`);return l!==-1&&(o=ce(o,n,r,l)),r+o+n};Object.defineProperties(gt.prototype,it);var lo=gt(),er=gt({level:ue?ue.level:0});var ct=lo;var Zt=F("@yarnpkg/core"),Rt=F("@yarnpkg/fslib"),Ie=F("@yarnpkg/parsers"),Pe=Et(He());var ut="root",tt="catalog:",mt={CATALOGS_YML:"catalogs.yml",YARNRC_YML:".yarnrc.yml"};var Lt=class{constructor(){this.configCache=new Map}async readConfiguration(o){let r=o.cwd,n=this.configCache.get(r);if(n)return n;let l=o.configuration.get("catalog"),c=o.configuration.get("catalogs"),f=Rt.ppath.join(o.cwd,mt.CATALOGS_YML),g={};try{if(await Rt.xfs.existsPromise(f)){let h=await Rt.xfs.readFilePromise(f,"utf8");g=(0,Ie.parseSyml)(h)?.options||{}}}catch{}let y={options:g,catalogs:{}};if(l instanceof Map&&l.size>0&&y.catalogs&&(y.catalogs[ut]=Object.fromEntries(l)),c instanceof Map&&c.size>0)for(let[h,E]of c.entries())E instanceof Map&&y.catalogs&&(y.catalogs[h]=Object.fromEntries(E));return this.configCache.set(r,y),y}async getRange(o,t,r){let n=await this.readConfiguration(o),l=t.length===0?ut:t,c=n.catalogs?.[l];if(c&&typeof c=="object"){let f=c[r];if(f)return f}return null}async findAllAccessibleGroups(o,t){let r=await this.readConfiguration(o),n=[];for(let[l,c]of Object.entries(r.catalogs||{}))typeof c=="object"&&c[t]&&n.push(l);return n}async findDependency(o,t){let r=Zt.structUtils.stringifyIdent(t),n=await this.readConfiguration(o),l=[];for(let[c,f]of Object.entries(n.catalogs||{}))if(typeof f=="object"){let g=f[r];g&&l.push([c,g])}return l}clearCache(o){this.configCache.delete(o)}async shouldIgnoreWorkspace(o){if(!o.manifest.name)return!1;let t=await this.readConfiguration(o.project);return t.options?.ignoredWorkspaces?(0,Pe.isMatch)(Zt.structUtils.stringifyIdent(o.manifest.name),t.options.ignoredWorkspaces):!1}};var wt=class{constructor(o){this.configReader=o}async getGroupValidationLevel(o,t){let n=(await this.configReader.readConfiguration(o.project)).options?.validation||"warn";return typeof n=="string"?n:n[t]!==void 0?n[t]:"warn"}async getValidationLevelForPackage(o,t){let r=await this.configReader.findAllAccessibleGroups(o.project,t);if(r.length===0)return"off";let n=[];for(let l of r){let c=await this.getGroupValidationLevel(o,l);n.push(c)}return n.includes("strict")?"strict":n.includes("warn")?"warn":"off"}async getValidationLevel(o){let t=await this.configReader.readConfiguration(o.project);return t.options?.validation&&typeof t.options.validation=="string"?t.options.validation:"warn"}async getCatalogDependenciesWithoutProtocol(o){let t=[...Object.entries(o.manifest.raw.dependencies||{}),...Object.entries(o.manifest.raw.devDependencies||{})],r=[];for(let[n,l]of t){if(l.startsWith(tt))continue;let f=await this.configReader.findAllAccessibleGroups(o.project,n);if(f.length>0){let g=await this.getValidationLevelForPackage(o,n);g!=="off"&&r.push({packageName:n,validationLevel:g,applicableGroups:f})}}return r}async validateWorkspace(o){let t=await this.configReader.shouldIgnoreWorkspace(o),r=t?[]:await this.getCatalogDependenciesWithoutProtocol(o),n=[...Object.values(o.manifest.raw.dependencies||{}),...Object.values(o.manifest.raw.devDependencies||{})].some(l=>l.startsWith(tt));return{violations:r,isIgnored:t,hasCatalogProtocolWhenIgnored:t&&n}}};var Jt=F("@yarnpkg/core");var kt=class{constructor(o,t){this.configReader=o;this.validationService=t}async getDefaultAliasGroups(o){let t=await this.configReader.readConfiguration(o.project);if(t.options){if(await this.configReader.shouldIgnoreWorkspace(o))return[];if(t.options.default){if(Array.isArray(t.options.default))return t.options.default;if(t.options.default==="max"){let r=Object.keys(t.catalogs||{}),n=[...o.manifest.dependencies,...o.manifest.devDependencies],l=Object.fromEntries(r.map(f=>[f,0]));for(let[f,g]of n)if(g.range.startsWith(tt)){let y=g.range.substring(tt.length);l[y]=(l[y]||0)+1}let c=Math.max(...Object.values(l));return Object.keys(l).filter(f=>l[f]===c)}}}return[]}async applyDefaultAlias(o,t,r){if(r.range.startsWith(tt)){if(await this.configReader.shouldIgnoreWorkspace(o))throw new Error(ct.red("The workspace is ignored from the catalogs, but the dependency to add is using the catalog protocol. Consider removing the protocol."));return}if(await this.configReader.shouldIgnoreWorkspace(o))return;let n=await this.configReader.findDependency(o.project,r);if(n.length===0)return;let l=await this.getDefaultAliasGroups(o);if(l.length>0){for(let h of l)if(n.some(([E])=>E===h)){let C=`${tt}${h===ut?"":h}`,$=o.manifest[t];$&&typeof $=="object"&&"set"in $&&$.set(r.identHash,Jt.structUtils.makeDescriptor(r,C));return}}let c=n.map(([h])=>h===ut?"":h),f=c.filter(h=>h!=="").length>0?` (${c.join(", ")})`:"",g=await this.validationService.getValidationLevelForPackage(o,Jt.structUtils.stringifyIdent(r)),y=`\u27A4 ${r.name} is listed in the catalogs config${f}, but it seems you're adding it without the catalog protocol. Consider running 'yarn add ${r.name}@${tt}${c[0]}' instead.`;if(g==="strict")throw new Error(ct.red(y));g==="warn"&&console.warn(ct.yellow(y))}};var Me=F("@yarnpkg/cli"),It=F("@yarnpkg/core"),et=F("@yarnpkg/fslib"),pt=F("@yarnpkg/parsers"),Pt=F("clipanion");var Nt=class{getInheritanceChain(o){let t=o.split("/"),r=[];for(let n=0;n<t.length;n++)r.push(t.slice(0,n+1).join("/"));return r}resolveInheritance(o,t){let r=this.getInheritanceChain(o);for(let l of r)if(!t[l])throw new Error(`Catalog group "${l}" not found in inheritance chain for "${o}"`);let n={};for(let l of r)Object.assign(n,t[l]);return n}resolveAllGroups(o){let t={};for(let r of Object.keys(o))t[r]=this.resolveInheritance(r,o);return t}};var Fo=new Nt,Ht=class extends Me.BaseCommand{constructor(){super(...arguments);this.dryRun=Pt.Option.Boolean("--dry-run",!1,{description:"Show what would be applied without writing"})}static{this.paths=[["catalogs","apply"]]}static{this.usage=Pt.Command.Usage({description:"Apply catalog definitions from catalogs.yml to .yarnrc.yml",details:`
      This command reads catalog definitions from catalogs.yml (with inheritance support)
      and writes them to .yarnrc.yml, completely replacing existing catalog configurations.

      Inheritance is supported using the / delimiter (e.g., stable/canary inherits from stable).
      Child groups override parent package versions.
    `,examples:[["Apply catalogs from catalogs.yml","yarn catalogs apply"],["Preview changes without applying","yarn catalogs apply --dry-run"]]})}async execute(){let t=await It.Configuration.find(this.context.cwd,this.context.plugins),{project:r}=await It.Project.find(t,this.context.cwd),n=et.ppath.join(r.cwd,mt.CATALOGS_YML);if(!await et.xfs.existsPromise(n))return this.context.stdout.write(`Error: catalogs.yml not found in project root
`),1;let l=await et.xfs.readFilePromise(n,"utf8"),c=(0,pt.parseSyml)(l);if(!c.list)return this.context.stdout.write(`Error: catalogs.yml must have a "list" field
`),1;let{root:f,...g}=c.list,y={};for(let[S,Y]of Object.entries(g))Y&&(y[S]=Y);let h={};try{h=Fo.resolveAllGroups(y)}catch(S){return this.context.stdout.write(`Error: Failed to resolve inheritance: ${S.message}
`),1}let E=et.ppath.join(r.cwd,mt.YARNRC_YML),C={};if(await et.xfs.existsPromise(E)){let S=await et.xfs.readFilePromise(E,"utf8");C=(0,pt.parseSyml)(S)||{}}if(f&&Object.keys(f).length>0?C.catalog=f:delete C.catalog,Object.keys(h).length>0?C.catalogs=h:delete C.catalogs,this.dryRun)return this.context.stdout.write((0,pt.stringifySyml)(C)),0;await et.xfs.writeFilePromise(E,(0,pt.stringifySyml)(C));let $=[];f&&Object.keys(f).length>0&&$.push("1 root catalog");let b=Object.keys(h).length;return b>0&&$.push(`${b} named catalog group${b>1?"s":""}`),$.length===0?this.context.stdout.write(`No catalogs to apply
`):this.context.stdout.write(`\u2713 Applied ${$.join(" and ")} to .yarnrc.yml
`),0}};var Be=new Lt,De=new wt(Be),Ge=new kt(Be,De),Wo={commands:[Ht],hooks:{validateWorkspace:async(e,o)=>{let t=await De.validateWorkspace(e);if(t.violations.length>0){let r=t.violations.filter(c=>c.validationLevel==="strict"),n=t.violations.filter(c=>c.validationLevel==="warn"),l=c=>`The following dependencies are listed in the catalogs but not using the catalog protocol: ${c.map(g=>ct.yellow(g.packageName)).join(", ")}. Consider using the catalog protocol instead.`;r.length>0&&o.reportError(Mt.MessageName.INVALID_MANIFEST,l(r)),n.length>0&&o.reportWarning(Mt.MessageName.INVALID_MANIFEST,l(n))}t.hasCatalogProtocolWhenIgnored&&o.reportError(Mt.MessageName.INVALID_MANIFEST,"Workspace is ignored from the catalogs, but it has dependencies with the catalog protocol. Consider removing the protocol.")},afterWorkspaceDependencyAddition:async(e,o,t)=>{await Ge.applyDefaultAlias(e,o,t)},afterWorkspaceDependencyReplacement:async(e,o,t,r)=>{await Ge.applyDefaultAlias(e,o,r)}}},Uo=Wo;return qe(Vo);})();
return plugin;
}
};
