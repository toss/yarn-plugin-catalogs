/* eslint-disable */
//prettier-ignore
module.exports = {
name: "@yarnpkg/plugin-catalogs",
factory: function (require) {
"use strict";var plugin=(()=>{var Ue=Object.create;var xt=Object.defineProperty;var Ye=Object.getOwnPropertyDescriptor;var Ke=Object.getOwnPropertyNames;var Xe=Object.getPrototypeOf,qe=Object.prototype.hasOwnProperty;var K=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(r,t)=>(typeof require<"u"?require:r)[t]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var lt=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports),Qe=(e,r)=>{for(var t in r)xt(e,t,{get:r[t],enumerable:!0})},te=(e,r,t,o)=>{if(r&&typeof r=="object"||typeof r=="function")for(let n of Ke(r))!qe.call(e,n)&&n!==t&&xt(e,n,{get:()=>r[n],enumerable:!(o=Ye(r,n))||o.enumerable});return e};var Ot=(e,r,t)=>(t=e!=null?Ue(Xe(e)):{},te(r||!e||!e.__esModule?xt(t,"default",{value:e,enumerable:!0}):t,e)),Ze=e=>te(xt({},"__esModule",{value:!0}),e);var At=lt((io,me)=>{"use strict";var Z="\\\\/",fe=`[^${Z}]`,et="\\.",fr="\\+",gr="\\?",$t="\\/",dr="(?=.)",ge="[^/]",jt=`(?:${$t}|$)`,de=`(?:^|${$t})`,Wt=`${et}{1,2}${jt}`,hr=`(?!${et})`,mr=`(?!${de}${Wt})`,Ar=`(?!${et}{0,1}${jt})`,yr=`(?!${Wt})`,Rr=`[^.${$t}]`,br=`${ge}*?`,Cr="/",he={DOT_LITERAL:et,PLUS_LITERAL:fr,QMARK_LITERAL:gr,SLASH_LITERAL:$t,ONE_CHAR:dr,QMARK:ge,END_ANCHOR:jt,DOTS_SLASH:Wt,NO_DOT:hr,NO_DOTS:mr,NO_DOT_SLASH:Ar,NO_DOTS_SLASH:yr,QMARK_NO_DOT:Rr,STAR:br,START_ANCHOR:de,SEP:Cr},_r={...he,SLASH_LITERAL:`[${Z}]`,QMARK:fe,STAR:`${fe}*?`,DOTS_SLASH:`${et}{1,2}(?:[${Z}]|$)`,NO_DOT:`(?!${et})`,NO_DOTS:`(?!(?:^|[${Z}])${et}{1,2}(?:[${Z}]|$))`,NO_DOT_SLASH:`(?!${et}{0,1}(?:[${Z}]|$))`,NO_DOTS_SLASH:`(?!${et}{1,2}(?:[${Z}]|$))`,QMARK_NO_DOT:`[^.${Z}]`,START_ANCHOR:`(?:^|[${Z}])`,END_ANCHOR:`(?:[${Z}]|$)`,SEP:"\\"},Er={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};me.exports={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:Er,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,extglobChars(e){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${e.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(e){return e===!0?_r:he}}});var yt=lt(W=>{"use strict";var{REGEX_BACKSLASH:xr,REGEX_REMOVE_BACKSLASH:Or,REGEX_SPECIAL_CHARS:Sr,REGEX_SPECIAL_CHARS_GLOBAL:vr}=At();W.isObject=e=>e!==null&&typeof e=="object"&&!Array.isArray(e);W.hasRegexChars=e=>Sr.test(e);W.isRegexChar=e=>e.length===1&&W.hasRegexChars(e);W.escapeRegex=e=>e.replace(vr,"\\$1");W.toPosixSlashes=e=>e.replace(xr,"/");W.isWindows=()=>{if(typeof navigator<"u"&&navigator.platform){let e=navigator.platform.toLowerCase();return e==="win32"||e==="windows"}return typeof process<"u"&&process.platform?process.platform==="win32":!1};W.removeBackslashes=e=>e.replace(Or,r=>r==="\\"?"":r);W.escapeLast=(e,r,t)=>{let o=e.lastIndexOf(r,t);return o===-1?e:e[o-1]==="\\"?W.escapeLast(e,r,o-1):`${e.slice(0,o)}\\${e.slice(o)}`};W.removePrefix=(e,r={})=>{let t=e;return t.startsWith("./")&&(t=t.slice(2),r.prefix="./"),t};W.wrapOutput=(e,r={},t={})=>{let o=t.contains?"":"^",n=t.contains?"":"$",i=`${o}(?:${e})${n}`;return r.negated===!0&&(i=`(?:^(?!${i}).*$)`),i};W.basename=(e,{windows:r}={})=>{let t=e.split(r?/[\\/]/:"/"),o=t[t.length-1];return o===""?t[t.length-2]:o}});var xe=lt((lo,Ee)=>{"use strict";var Ae=yt(),{CHAR_ASTERISK:Ft,CHAR_AT:Tr,CHAR_BACKWARD_SLASH:Rt,CHAR_COMMA:$r,CHAR_DOT:Vt,CHAR_EXCLAMATION_MARK:Ut,CHAR_FORWARD_SLASH:_e,CHAR_LEFT_CURLY_BRACE:Yt,CHAR_LEFT_PARENTHESES:Kt,CHAR_LEFT_SQUARE_BRACKET:Lr,CHAR_PLUS:wr,CHAR_QUESTION_MARK:ye,CHAR_RIGHT_CURLY_BRACE:Ir,CHAR_RIGHT_PARENTHESES:Re,CHAR_RIGHT_SQUARE_BRACKET:kr}=At(),be=e=>e===_e||e===Rt,Ce=e=>{e.isPrefix!==!0&&(e.depth=e.isGlobstar?1/0:1)},Nr=(e,r)=>{let t=r||{},o=e.length-1,n=t.parts===!0||t.scanToEnd===!0,i=[],l=[],f=[],g=e,h=-1,R=0,I=0,v=!1,M=!1,b=!1,N=!1,at=!1,q=!1,_=!1,Q=!1,it=!1,G=!1,H=0,F,d,A={value:"",depth:0,isGlob:!1},c=()=>h>=o,B=()=>g.charCodeAt(h+1),w=()=>(F=d,g.charCodeAt(++h));for(;h<o;){d=w();let C;if(d===Rt){_=A.backslashes=!0,d=w(),d===Yt&&(q=!0);continue}if(q===!0||d===Yt){for(H++;c()!==!0&&(d=w());){if(d===Rt){_=A.backslashes=!0,w();continue}if(d===Yt){H++;continue}if(q!==!0&&d===Vt&&(d=w())===Vt){if(v=A.isBrace=!0,b=A.isGlob=!0,G=!0,n===!0)continue;break}if(q!==!0&&d===$r){if(v=A.isBrace=!0,b=A.isGlob=!0,G=!0,n===!0)continue;break}if(d===Ir&&(H--,H===0)){q=!1,v=A.isBrace=!0,G=!0;break}}if(n===!0)continue;break}if(d===_e){if(i.push(h),l.push(A),A={value:"",depth:0,isGlob:!1},G===!0)continue;if(F===Vt&&h===R+1){R+=2;continue}I=h+1;continue}if(t.noext!==!0&&(d===wr||d===Tr||d===Ft||d===ye||d===Ut)===!0&&B()===Kt){if(b=A.isGlob=!0,N=A.isExtglob=!0,G=!0,d===Ut&&h===R&&(it=!0),n===!0){for(;c()!==!0&&(d=w());){if(d===Rt){_=A.backslashes=!0,d=w();continue}if(d===Re){b=A.isGlob=!0,G=!0;break}}continue}break}if(d===Ft){if(F===Ft&&(at=A.isGlobstar=!0),b=A.isGlob=!0,G=!0,n===!0)continue;break}if(d===ye){if(b=A.isGlob=!0,G=!0,n===!0)continue;break}if(d===Lr){for(;c()!==!0&&(C=w());){if(C===Rt){_=A.backslashes=!0,w();continue}if(C===kr){M=A.isBracket=!0,b=A.isGlob=!0,G=!0;break}}if(n===!0)continue;break}if(t.nonegate!==!0&&d===Ut&&h===R){Q=A.negated=!0,R++;continue}if(t.noparen!==!0&&d===Kt){if(b=A.isGlob=!0,n===!0){for(;c()!==!0&&(d=w());){if(d===Kt){_=A.backslashes=!0,d=w();continue}if(d===Re){G=!0;break}}continue}break}if(b===!0){if(G=!0,n===!0)continue;break}}t.noext===!0&&(N=!1,b=!1);let $=g,s="",a="";R>0&&(s=g.slice(0,R),g=g.slice(R),I-=R),$&&b===!0&&I>0?($=g.slice(0,I),a=g.slice(I)):b===!0?($="",a=g):$=g,$&&$!==""&&$!=="/"&&$!==g&&be($.charCodeAt($.length-1))&&($=$.slice(0,-1)),t.unescape===!0&&(a&&(a=Ae.removeBackslashes(a)),$&&_===!0&&($=Ae.removeBackslashes($)));let V={prefix:s,input:e,start:R,base:$,glob:a,isBrace:v,isBracket:M,isGlob:b,isExtglob:N,isGlobstar:at,negated:Q,negatedExtglob:it};if(t.tokens===!0&&(V.maxDepth=0,be(d)||l.push(A),V.tokens=l),t.parts===!0||t.tokens===!0){let C;for(let O=0;O<i.length;O++){let tt=C?C+1:R,U=i[O],st=e.slice(tt,U);t.tokens&&(O===0&&R!==0?(l[O].isPrefix=!0,l[O].value=s):l[O].value=st,Ce(l[O]),V.maxDepth+=l[O].depth),(O!==0||st!=="")&&f.push(st),C=U}if(C&&C+1<e.length){let O=e.slice(C+1);f.push(O),t.tokens&&(l[l.length-1].value=O,Ce(l[l.length-1]),V.maxDepth+=l[l.length-1].depth)}V.slashes=i,V.parts=f}return V};Ee.exports=Nr});var ve=lt((uo,Se)=>{"use strict";var Lt=At(),z=yt(),{MAX_LENGTH:wt,POSIX_REGEX_SOURCE:Hr,REGEX_NON_SPECIAL_CHARS:Pr,REGEX_SPECIAL_CHARS_BACKREF:Mr,REPLACEMENTS:Oe}=Lt,Gr=(e,r)=>{if(typeof r.expandRange=="function")return r.expandRange(...e,r);e.sort();let t=`[${e.join("-")}]`;try{new RegExp(t)}catch{return e.map(n=>z.escapeRegex(n)).join("..")}return t},ft=(e,r)=>`Missing ${e}: "${r}" - use "\\\\${r}" to match literal characters`,Xt=(e,r)=>{if(typeof e!="string")throw new TypeError("Expected a string");e=Oe[e]||e;let t={...r},o=typeof t.maxLength=="number"?Math.min(wt,t.maxLength):wt,n=e.length;if(n>o)throw new SyntaxError(`Input length: ${n}, exceeds maximum allowed length: ${o}`);let i={type:"bos",value:"",output:t.prepend||""},l=[i],f=t.capture?"":"?:",g=Lt.globChars(t.windows),h=Lt.extglobChars(g),{DOT_LITERAL:R,PLUS_LITERAL:I,SLASH_LITERAL:v,ONE_CHAR:M,DOTS_SLASH:b,NO_DOT:N,NO_DOT_SLASH:at,NO_DOTS_SLASH:q,QMARK:_,QMARK_NO_DOT:Q,STAR:it,START_ANCHOR:G}=g,H=p=>`(${f}(?:(?!${G}${p.dot?b:R}).)*?)`,F=t.dot?"":N,d=t.dot?_:Q,A=t.bash===!0?H(t):it;t.capture&&(A=`(${A})`),typeof t.noext=="boolean"&&(t.noextglob=t.noext);let c={input:e,index:-1,start:0,dot:t.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:l};e=z.removePrefix(e,c),n=e.length;let B=[],w=[],$=[],s=i,a,V=()=>c.index===n-1,C=c.peek=(p=1)=>e[c.index+p],O=c.advance=()=>e[++c.index]||"",tt=()=>e.slice(c.index+1),U=(p="",E=0)=>{c.consumed+=p,c.index+=E},st=p=>{c.output+=p.output!=null?p.output:p.value,U(p.value)},Fe=()=>{let p=1;for(;C()==="!"&&(C(2)!=="("||C(3)==="?");)O(),c.start++,p++;return p%2===0?!1:(c.negated=!0,c.start++,!0)},Ct=p=>{c[p]++,$.push(p)},ct=p=>{c[p]--,$.pop()},y=p=>{if(s.type==="globstar"){let E=c.braces>0&&(p.type==="comma"||p.type==="brace"),u=p.extglob===!0||B.length&&(p.type==="pipe"||p.type==="paren");p.type!=="slash"&&p.type!=="paren"&&!E&&!u&&(c.output=c.output.slice(0,-s.output.length),s.type="star",s.value="*",s.output=A,c.output+=s.output)}if(B.length&&p.type!=="paren"&&(B[B.length-1].inner+=p.value),(p.value||p.output)&&st(p),s&&s.type==="text"&&p.type==="text"){s.output=(s.output||s.value)+p.value,s.value+=p.value;return}p.prev=s,l.push(p),s=p},_t=(p,E)=>{let u={...h[E],conditions:1,inner:""};u.prev=s,u.parens=c.parens,u.output=c.output;let m=(t.capture?"(":"")+u.open;Ct("parens"),y({type:p,value:E,output:c.output?"":M}),y({type:"paren",extglob:!0,value:O(),output:m}),B.push(u)},Ve=p=>{let E=p.close+(t.capture?")":""),u;if(p.type==="negate"){let m=A;if(p.inner&&p.inner.length>1&&p.inner.includes("/")&&(m=H(t)),(m!==A||V()||/^\)+$/.test(tt()))&&(E=p.close=`)$))${m}`),p.inner.includes("*")&&(u=tt())&&/^\.[^\\/.]+$/.test(u)){let S=Xt(u,{...r,fastpaths:!1}).output;E=p.close=`)${S})${m})`}p.prev.type==="bos"&&(c.negatedExtglob=!0)}y({type:"paren",extglob:!0,value:a,output:E}),ct("parens")};if(t.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(e)){let p=!1,E=e.replace(Mr,(u,m,S,D,k,Pt)=>D==="\\"?(p=!0,u):D==="?"?m?m+D+(k?_.repeat(k.length):""):Pt===0?d+(k?_.repeat(k.length):""):_.repeat(S.length):D==="."?R.repeat(S.length):D==="*"?m?m+D+(k?A:""):A:m?u:`\\${u}`);return p===!0&&(t.unescape===!0?E=E.replace(/\\/g,""):E=E.replace(/\\+/g,u=>u.length%2===0?"\\\\":u?"\\":"")),E===e&&t.contains===!0?(c.output=e,c):(c.output=z.wrapOutput(E,c,r),c)}for(;!V();){if(a=O(),a==="\0")continue;if(a==="\\"){let u=C();if(u==="/"&&t.bash!==!0||u==="."||u===";")continue;if(!u){a+="\\",y({type:"text",value:a});continue}let m=/^\\+/.exec(tt()),S=0;if(m&&m[0].length>2&&(S=m[0].length,c.index+=S,S%2!==0&&(a+="\\")),t.unescape===!0?a=O():a+=O(),c.brackets===0){y({type:"text",value:a});continue}}if(c.brackets>0&&(a!=="]"||s.value==="["||s.value==="[^")){if(t.posix!==!1&&a===":"){let u=s.value.slice(1);if(u.includes("[")&&(s.posix=!0,u.includes(":"))){let m=s.value.lastIndexOf("["),S=s.value.slice(0,m),D=s.value.slice(m+2),k=Hr[D];if(k){s.value=S+k,c.backtrack=!0,O(),!i.output&&l.indexOf(s)===1&&(i.output=M);continue}}}(a==="["&&C()!==":"||a==="-"&&C()==="]")&&(a=`\\${a}`),a==="]"&&(s.value==="["||s.value==="[^")&&(a=`\\${a}`),t.posix===!0&&a==="!"&&s.value==="["&&(a="^"),s.value+=a,st({value:a});continue}if(c.quotes===1&&a!=='"'){a=z.escapeRegex(a),s.value+=a,st({value:a});continue}if(a==='"'){c.quotes=c.quotes===1?0:1,t.keepQuotes===!0&&y({type:"text",value:a});continue}if(a==="("){Ct("parens"),y({type:"paren",value:a});continue}if(a===")"){if(c.parens===0&&t.strictBrackets===!0)throw new SyntaxError(ft("opening","("));let u=B[B.length-1];if(u&&c.parens===u.parens+1){Ve(B.pop());continue}y({type:"paren",value:a,output:c.parens?")":"\\)"}),ct("parens");continue}if(a==="["){if(t.nobracket===!0||!tt().includes("]")){if(t.nobracket!==!0&&t.strictBrackets===!0)throw new SyntaxError(ft("closing","]"));a=`\\${a}`}else Ct("brackets");y({type:"bracket",value:a});continue}if(a==="]"){if(t.nobracket===!0||s&&s.type==="bracket"&&s.value.length===1){y({type:"text",value:a,output:`\\${a}`});continue}if(c.brackets===0){if(t.strictBrackets===!0)throw new SyntaxError(ft("opening","["));y({type:"text",value:a,output:`\\${a}`});continue}ct("brackets");let u=s.value.slice(1);if(s.posix!==!0&&u[0]==="^"&&!u.includes("/")&&(a=`/${a}`),s.value+=a,st({value:a}),t.literalBrackets===!1||z.hasRegexChars(u))continue;let m=z.escapeRegex(s.value);if(c.output=c.output.slice(0,-s.value.length),t.literalBrackets===!0){c.output+=m,s.value=m;continue}s.value=`(${f}${m}|${s.value})`,c.output+=s.value;continue}if(a==="{"&&t.nobrace!==!0){Ct("braces");let u={type:"brace",value:a,output:"(",outputIndex:c.output.length,tokensIndex:c.tokens.length};w.push(u),y(u);continue}if(a==="}"){let u=w[w.length-1];if(t.nobrace===!0||!u){y({type:"text",value:a,output:a});continue}let m=")";if(u.dots===!0){let S=l.slice(),D=[];for(let k=S.length-1;k>=0&&(l.pop(),S[k].type!=="brace");k--)S[k].type!=="dots"&&D.unshift(S[k].value);m=Gr(D,t),c.backtrack=!0}if(u.comma!==!0&&u.dots!==!0){let S=c.output.slice(0,u.outputIndex),D=c.tokens.slice(u.tokensIndex);u.value=u.output="\\{",a=m="\\}",c.output=S;for(let k of D)c.output+=k.output||k.value}y({type:"brace",value:a,output:m}),ct("braces"),w.pop();continue}if(a==="|"){B.length>0&&B[B.length-1].conditions++,y({type:"text",value:a});continue}if(a===","){let u=a,m=w[w.length-1];m&&$[$.length-1]==="braces"&&(m.comma=!0,u="|"),y({type:"comma",value:a,output:u});continue}if(a==="/"){if(s.type==="dot"&&c.index===c.start+1){c.start=c.index+1,c.consumed="",c.output="",l.pop(),s=i;continue}y({type:"slash",value:a,output:v});continue}if(a==="."){if(c.braces>0&&s.type==="dot"){s.value==="."&&(s.output=R);let u=w[w.length-1];s.type="dots",s.output+=a,s.value+=a,u.dots=!0;continue}if(c.braces+c.parens===0&&s.type!=="bos"&&s.type!=="slash"){y({type:"text",value:a,output:R});continue}y({type:"dot",value:a,output:R});continue}if(a==="?"){if(!(s&&s.value==="(")&&t.noextglob!==!0&&C()==="("&&C(2)!=="?"){_t("qmark",a);continue}if(s&&s.type==="paren"){let m=C(),S=a;(s.value==="("&&!/[!=<:]/.test(m)||m==="<"&&!/<([!=]|\w+>)/.test(tt()))&&(S=`\\${a}`),y({type:"text",value:a,output:S});continue}if(t.dot!==!0&&(s.type==="slash"||s.type==="bos")){y({type:"qmark",value:a,output:Q});continue}y({type:"qmark",value:a,output:_});continue}if(a==="!"){if(t.noextglob!==!0&&C()==="("&&(C(2)!=="?"||!/[!=<:]/.test(C(3)))){_t("negate",a);continue}if(t.nonegate!==!0&&c.index===0){Fe();continue}}if(a==="+"){if(t.noextglob!==!0&&C()==="("&&C(2)!=="?"){_t("plus",a);continue}if(s&&s.value==="("||t.regex===!1){y({type:"plus",value:a,output:I});continue}if(s&&(s.type==="bracket"||s.type==="paren"||s.type==="brace")||c.parens>0){y({type:"plus",value:a});continue}y({type:"plus",value:I});continue}if(a==="@"){if(t.noextglob!==!0&&C()==="("&&C(2)!=="?"){y({type:"at",extglob:!0,value:a,output:""});continue}y({type:"text",value:a});continue}if(a!=="*"){(a==="$"||a==="^")&&(a=`\\${a}`);let u=Pr.exec(tt());u&&(a+=u[0],c.index+=u[0].length),y({type:"text",value:a});continue}if(s&&(s.type==="globstar"||s.star===!0)){s.type="star",s.star=!0,s.value+=a,s.output=A,c.backtrack=!0,c.globstar=!0,U(a);continue}let p=tt();if(t.noextglob!==!0&&/^\([^?]/.test(p)){_t("star",a);continue}if(s.type==="star"){if(t.noglobstar===!0){U(a);continue}let u=s.prev,m=u.prev,S=u.type==="slash"||u.type==="bos",D=m&&(m.type==="star"||m.type==="globstar");if(t.bash===!0&&(!S||p[0]&&p[0]!=="/")){y({type:"star",value:a,output:""});continue}let k=c.braces>0&&(u.type==="comma"||u.type==="brace"),Pt=B.length&&(u.type==="pipe"||u.type==="paren");if(!S&&u.type!=="paren"&&!k&&!Pt){y({type:"star",value:a,output:""});continue}for(;p.slice(0,3)==="/**";){let Et=e[c.index+4];if(Et&&Et!=="/")break;p=p.slice(3),U("/**",3)}if(u.type==="bos"&&V()){s.type="globstar",s.value+=a,s.output=H(t),c.output=s.output,c.globstar=!0,U(a);continue}if(u.type==="slash"&&u.prev.type!=="bos"&&!D&&V()){c.output=c.output.slice(0,-(u.output+s.output).length),u.output=`(?:${u.output}`,s.type="globstar",s.output=H(t)+(t.strictSlashes?")":"|$)"),s.value+=a,c.globstar=!0,c.output+=u.output+s.output,U(a);continue}if(u.type==="slash"&&u.prev.type!=="bos"&&p[0]==="/"){let Et=p[1]!==void 0?"|$":"";c.output=c.output.slice(0,-(u.output+s.output).length),u.output=`(?:${u.output}`,s.type="globstar",s.output=`${H(t)}${v}|${v}${Et})`,s.value+=a,c.output+=u.output+s.output,c.globstar=!0,U(a+O()),y({type:"slash",value:"/",output:""});continue}if(u.type==="bos"&&p[0]==="/"){s.type="globstar",s.value+=a,s.output=`(?:^|${v}|${H(t)}${v})`,c.output=s.output,c.globstar=!0,U(a+O()),y({type:"slash",value:"/",output:""});continue}c.output=c.output.slice(0,-s.output.length),s.type="globstar",s.output=H(t),s.value+=a,c.output+=s.output,c.globstar=!0,U(a);continue}let E={type:"star",value:a,output:A};if(t.bash===!0){E.output=".*?",(s.type==="bos"||s.type==="slash")&&(E.output=F+E.output),y(E);continue}if(s&&(s.type==="bracket"||s.type==="paren")&&t.regex===!0){E.output=a,y(E);continue}(c.index===c.start||s.type==="slash"||s.type==="dot")&&(s.type==="dot"?(c.output+=at,s.output+=at):t.dot===!0?(c.output+=q,s.output+=q):(c.output+=F,s.output+=F),C()!=="*"&&(c.output+=M,s.output+=M)),y(E)}for(;c.brackets>0;){if(t.strictBrackets===!0)throw new SyntaxError(ft("closing","]"));c.output=z.escapeLast(c.output,"["),ct("brackets")}for(;c.parens>0;){if(t.strictBrackets===!0)throw new SyntaxError(ft("closing",")"));c.output=z.escapeLast(c.output,"("),ct("parens")}for(;c.braces>0;){if(t.strictBrackets===!0)throw new SyntaxError(ft("closing","}"));c.output=z.escapeLast(c.output,"{"),ct("braces")}if(t.strictSlashes!==!0&&(s.type==="star"||s.type==="bracket")&&y({type:"maybe_slash",value:"",output:`${v}?`}),c.backtrack===!0){c.output="";for(let p of c.tokens)c.output+=p.output!=null?p.output:p.value,p.suffix&&(c.output+=p.suffix)}return c};Xt.fastpaths=(e,r)=>{let t={...r},o=typeof t.maxLength=="number"?Math.min(wt,t.maxLength):wt,n=e.length;if(n>o)throw new SyntaxError(`Input length: ${n}, exceeds maximum allowed length: ${o}`);e=Oe[e]||e;let{DOT_LITERAL:i,SLASH_LITERAL:l,ONE_CHAR:f,DOTS_SLASH:g,NO_DOT:h,NO_DOTS:R,NO_DOTS_SLASH:I,STAR:v,START_ANCHOR:M}=Lt.globChars(t.windows),b=t.dot?R:h,N=t.dot?I:h,at=t.capture?"":"?:",q={negated:!1,prefix:""},_=t.bash===!0?".*?":v;t.capture&&(_=`(${_})`);let Q=F=>F.noglobstar===!0?_:`(${at}(?:(?!${M}${F.dot?g:i}).)*?)`,it=F=>{switch(F){case"*":return`${b}${f}${_}`;case".*":return`${i}${f}${_}`;case"*.*":return`${b}${_}${i}${f}${_}`;case"*/*":return`${b}${_}${l}${f}${N}${_}`;case"**":return b+Q(t);case"**/*":return`(?:${b}${Q(t)}${l})?${N}${f}${_}`;case"**/*.*":return`(?:${b}${Q(t)}${l})?${N}${_}${i}${f}${_}`;case"**/.*":return`(?:${b}${Q(t)}${l})?${i}${f}${_}`;default:{let d=/^(.*?)\.(\w+)$/.exec(F);if(!d)return;let A=it(d[1]);return A?A+i+d[2]:void 0}}},G=z.removePrefix(e,q),H=it(G);return H&&t.strictSlashes!==!0&&(H+=`${l}?`),H};Se.exports=Xt});var Le=lt((po,$e)=>{"use strict";var Dr=xe(),qt=ve(),Te=yt(),Br=At(),jr=e=>e&&typeof e=="object"&&!Array.isArray(e),L=(e,r,t=!1)=>{if(Array.isArray(e)){let R=e.map(v=>L(v,r,t));return v=>{for(let M of R){let b=M(v);if(b)return b}return!1}}let o=jr(e)&&e.tokens&&e.input;if(e===""||typeof e!="string"&&!o)throw new TypeError("Expected pattern to be a non-empty string");let n=r||{},i=n.windows,l=o?L.compileRe(e,r):L.makeRe(e,r,!1,!0),f=l.state;delete l.state;let g=()=>!1;if(n.ignore){let R={...r,ignore:null,onMatch:null,onResult:null};g=L(n.ignore,R,t)}let h=(R,I=!1)=>{let{isMatch:v,match:M,output:b}=L.test(R,l,r,{glob:e,posix:i}),N={glob:e,state:f,regex:l,posix:i,input:R,output:b,match:M,isMatch:v};return typeof n.onResult=="function"&&n.onResult(N),v===!1?(N.isMatch=!1,I?N:!1):g(R)?(typeof n.onIgnore=="function"&&n.onIgnore(N),N.isMatch=!1,I?N:!1):(typeof n.onMatch=="function"&&n.onMatch(N),I?N:!0)};return t&&(h.state=f),h};L.test=(e,r,t,{glob:o,posix:n}={})=>{if(typeof e!="string")throw new TypeError("Expected input to be a string");if(e==="")return{isMatch:!1,output:""};let i=t||{},l=i.format||(n?Te.toPosixSlashes:null),f=e===o,g=f&&l?l(e):e;return f===!1&&(g=l?l(e):e,f=g===o),(f===!1||i.capture===!0)&&(i.matchBase===!0||i.basename===!0?f=L.matchBase(e,r,t,n):f=r.exec(g)),{isMatch:!!f,match:f,output:g}};L.matchBase=(e,r,t)=>(r instanceof RegExp?r:L.makeRe(r,t)).test(Te.basename(e));L.isMatch=(e,r,t)=>L(r,t)(e);L.parse=(e,r)=>Array.isArray(e)?e.map(t=>L.parse(t,r)):qt(e,{...r,fastpaths:!1});L.scan=(e,r)=>Dr(e,r);L.compileRe=(e,r,t=!1,o=!1)=>{if(t===!0)return e.output;let n=r||{},i=n.contains?"":"^",l=n.contains?"":"$",f=`${i}(?:${e.output})${l}`;e&&e.negated===!0&&(f=`^(?!${f}).*$`);let g=L.toRegex(f,r);return o===!0&&(g.state=e),g};L.makeRe=(e,r={},t=!1,o=!1)=>{if(!e||typeof e!="string")throw new TypeError("Expected a non-empty string");let n={negated:!1,fastpaths:!0};return r.fastpaths!==!1&&(e[0]==="."||e[0]==="*")&&(n.output=qt.fastpaths(e,r)),n.output||(n=qt(e,r)),L.compileRe(n,r,t,o)};L.toRegex=(e,r)=>{try{let t=r||{};return new RegExp(e,t.flags||(t.nocase?"i":""))}catch(t){if(r&&r.debug===!0)throw t;return/$^/}};L.constants=Br;$e.exports=L});var Ne=lt((fo,ke)=>{"use strict";var we=Le(),Wr=yt();function Ie(e,r,t=!1){return r&&(r.windows===null||r.windows===void 0)&&(r={...r,windows:Wr.isWindows()}),we(e,r,t)}Object.assign(Ie,we);ke.exports=Ie});var qr={};Qe(qr,{default:()=>Xr});var dt=K("@yarnpkg/core");var ee=(e=0)=>r=>`\x1B[${r+e}m`,re=(e=0)=>r=>`\x1B[${38+e};5;${r}m`,oe=(e=0)=>(r,t,o)=>`\x1B[${38+e};2;${r};${t};${o}m`,x={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],gray:[90,39],grey:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgGray:[100,49],bgGrey:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}},Zr=Object.keys(x.modifier),ze=Object.keys(x.color),Je=Object.keys(x.bgColor),zr=[...ze,...Je];function tr(){let e=new Map;for(let[r,t]of Object.entries(x)){for(let[o,n]of Object.entries(t))x[o]={open:`\x1B[${n[0]}m`,close:`\x1B[${n[1]}m`},t[o]=x[o],e.set(n[0],n[1]);Object.defineProperty(x,r,{value:t,enumerable:!1})}return Object.defineProperty(x,"codes",{value:e,enumerable:!1}),x.color.close="\x1B[39m",x.bgColor.close="\x1B[49m",x.color.ansi=ee(),x.color.ansi256=re(),x.color.ansi16m=oe(),x.bgColor.ansi=ee(10),x.bgColor.ansi256=re(10),x.bgColor.ansi16m=oe(10),Object.defineProperties(x,{rgbToAnsi256:{value(r,t,o){return r===t&&t===o?r<8?16:r>248?231:Math.round((r-8)/247*24)+232:16+36*Math.round(r/255*5)+6*Math.round(t/255*5)+Math.round(o/255*5)},enumerable:!1},hexToRgb:{value(r){let t=/[a-f\d]{6}|[a-f\d]{3}/i.exec(r.toString(16));if(!t)return[0,0,0];let[o]=t;o.length===3&&(o=[...o].map(i=>i+i).join(""));let n=Number.parseInt(o,16);return[n>>16&255,n>>8&255,n&255]},enumerable:!1},hexToAnsi256:{value:r=>x.rgbToAnsi256(...x.hexToRgb(r)),enumerable:!1},ansi256ToAnsi:{value(r){if(r<8)return 30+r;if(r<16)return 90+(r-8);let t,o,n;if(r>=232)t=((r-232)*10+8)/255,o=t,n=t;else{r-=16;let f=r%36;t=Math.floor(r/36)/5,o=Math.floor(f/6)/5,n=f%6/5}let i=Math.max(t,o,n)*2;if(i===0)return 30;let l=30+(Math.round(n)<<2|Math.round(o)<<1|Math.round(t));return i===2&&(l+=60),l},enumerable:!1},rgbToAnsi:{value:(r,t,o)=>x.ansi256ToAnsi(x.rgbToAnsi256(r,t,o)),enumerable:!1},hexToAnsi:{value:r=>x.ansi256ToAnsi(x.hexToAnsi256(r)),enumerable:!1}}),x}var er=tr(),X=er;var vt=Ot(K("process"),1),se=Ot(K("os"),1),Mt=Ot(K("tty"),1);function Y(e,r=globalThis.Deno?globalThis.Deno.args:vt.default.argv){let t=e.startsWith("-")?"":e.length===1?"-":"--",o=r.indexOf(t+e),n=r.indexOf("--");return o!==-1&&(n===-1||o<n)}var{env:T}=vt.default,St;Y("no-color")||Y("no-colors")||Y("color=false")||Y("color=never")?St=0:(Y("color")||Y("colors")||Y("color=true")||Y("color=always"))&&(St=1);function rr(){if("FORCE_COLOR"in T)return T.FORCE_COLOR==="true"?1:T.FORCE_COLOR==="false"?0:T.FORCE_COLOR.length===0?1:Math.min(Number.parseInt(T.FORCE_COLOR,10),3)}function or(e){return e===0?!1:{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}function nr(e,{streamIsTTY:r,sniffFlags:t=!0}={}){let o=rr();o!==void 0&&(St=o);let n=t?St:o;if(n===0)return 0;if(t){if(Y("color=16m")||Y("color=full")||Y("color=truecolor"))return 3;if(Y("color=256"))return 2}if("TF_BUILD"in T&&"AGENT_NAME"in T)return 1;if(e&&!r&&n===void 0)return 0;let i=n||0;if(T.TERM==="dumb")return i;if(vt.default.platform==="win32"){let l=se.default.release().split(".");return Number(l[0])>=10&&Number(l[2])>=10586?Number(l[2])>=14931?3:2:1}if("CI"in T)return["GITHUB_ACTIONS","GITEA_ACTIONS","CIRCLECI"].some(l=>l in T)?3:["TRAVIS","APPVEYOR","GITLAB_CI","BUILDKITE","DRONE"].some(l=>l in T)||T.CI_NAME==="codeship"?1:i;if("TEAMCITY_VERSION"in T)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(T.TEAMCITY_VERSION)?1:0;if(T.COLORTERM==="truecolor"||T.TERM==="xterm-kitty")return 3;if("TERM_PROGRAM"in T){let l=Number.parseInt((T.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(T.TERM_PROGRAM){case"iTerm.app":return l>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(T.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(T.TERM)||"COLORTERM"in T?1:i}function ne(e,r={}){let t=nr(e,{streamIsTTY:e&&e.isTTY,...r});return or(t)}var sr={stdout:ne({isTTY:Mt.default.isatty(1)}),stderr:ne({isTTY:Mt.default.isatty(2)})},ae=sr;function ie(e,r,t){let o=e.indexOf(r);if(o===-1)return e;let n=r.length,i=0,l="";do l+=e.slice(i,o)+r+t,i=o+n,o=e.indexOf(r,i);while(o!==-1);return l+=e.slice(i),l}function ce(e,r,t,o){let n=0,i="";do{let l=e[o-1]==="\r";i+=e.slice(n,l?o-1:o)+r+(l?`\r
`:`
`)+t,n=o+1,o=e.indexOf(`
`,n)}while(o!==-1);return i+=e.slice(n),i}var{stdout:le,stderr:ue}=ae,Gt=Symbol("GENERATOR"),ut=Symbol("STYLER"),ht=Symbol("IS_EMPTY"),pe=["ansi","ansi","ansi256","ansi16m"],pt=Object.create(null),ar=(e,r={})=>{if(r.level&&!(Number.isInteger(r.level)&&r.level>=0&&r.level<=3))throw new Error("The `level` option should be an integer from 0 to 3");let t=le?le.level:0;e.level=r.level===void 0?t:r.level};var ir=e=>{let r=(...t)=>t.join(" ");return ar(r,e),Object.setPrototypeOf(r,mt.prototype),r};function mt(e){return ir(e)}Object.setPrototypeOf(mt.prototype,Function.prototype);for(let[e,r]of Object.entries(X))pt[e]={get(){let t=Tt(this,Bt(r.open,r.close,this[ut]),this[ht]);return Object.defineProperty(this,e,{value:t}),t}};pt.visible={get(){let e=Tt(this,this[ut],!0);return Object.defineProperty(this,"visible",{value:e}),e}};var Dt=(e,r,t,...o)=>e==="rgb"?r==="ansi16m"?X[t].ansi16m(...o):r==="ansi256"?X[t].ansi256(X.rgbToAnsi256(...o)):X[t].ansi(X.rgbToAnsi(...o)):e==="hex"?Dt("rgb",r,t,...X.hexToRgb(...o)):X[t][e](...o),cr=["rgb","hex","ansi256"];for(let e of cr){pt[e]={get(){let{level:t}=this;return function(...o){let n=Bt(Dt(e,pe[t],"color",...o),X.color.close,this[ut]);return Tt(this,n,this[ht])}}};let r="bg"+e[0].toUpperCase()+e.slice(1);pt[r]={get(){let{level:t}=this;return function(...o){let n=Bt(Dt(e,pe[t],"bgColor",...o),X.bgColor.close,this[ut]);return Tt(this,n,this[ht])}}}}var lr=Object.defineProperties(()=>{},{...pt,level:{enumerable:!0,get(){return this[Gt].level},set(e){this[Gt].level=e}}}),Bt=(e,r,t)=>{let o,n;return t===void 0?(o=e,n=r):(o=t.openAll+e,n=r+t.closeAll),{open:e,close:r,openAll:o,closeAll:n,parent:t}},Tt=(e,r,t)=>{let o=(...n)=>ur(o,n.length===1?""+n[0]:n.join(" "));return Object.setPrototypeOf(o,lr),o[Gt]=e,o[ut]=r,o[ht]=t,o},ur=(e,r)=>{if(e.level<=0||!r)return e[ht]?"":r;let t=e[ut];if(t===void 0)return r;let{openAll:o,closeAll:n}=t;if(r.includes("\x1B"))for(;t!==void 0;)r=ie(r,t.close,t.open),t=t.parent;let i=r.indexOf(`
`);return i!==-1&&(r=ce(r,n,o,i)),o+r+n};Object.defineProperties(mt.prototype,pt);var pr=mt(),so=mt({level:ue?ue.level:0});var j=pr;var Be=K("@yarnpkg/cli"),gt=K("@yarnpkg/core");var Nt=K("clipanion");var Ge=K("@yarnpkg/core"),nt=K("@yarnpkg/fslib"),bt=K("@yarnpkg/parsers"),De=Ot(Ne());var rt="root",J="catalog:";var ot=class extends Error{constructor(t,o){super(t);this.code=o;this.name="CatalogConfigurationError"}static{this.FILE_NOT_FOUND="FILE_NOT_FOUND"}static{this.INVALID_FORMAT="INVALID_FORMAT"}static{this.INVALID_ALIAS="INVALID_ALIAS"}};function He(e){if(!e||typeof e!="object")return!1;let r=e;if(!("list"in r)||!r.list||typeof r.list!="object")return!1;for(let t of Object.values(r.list)){if(!t||typeof t!="object")return!1;for(let o of Object.values(t))if(typeof o!="string")return!1}if("options"in r&&r.options){let t=r.options;if(!t||typeof t!="object")return!1;let o=t;if(o.default){if(Array.isArray(o.default)){if(o.default.length===0||!o.default.every(n=>typeof n=="string"))return!1}else if(typeof o.default!="string"||o.default!=="max")return!1}if(o.ignoredWorkspaces&&(!Array.isArray(o.ignoredWorkspaces)||o.ignoredWorkspaces.length===0||!o.ignoredWorkspaces.every(n=>typeof n=="string")))return!1;if(o.validation){let n=["warn","strict","off"],i=o.validation;if(typeof i=="string"){if(!n.includes(i))return!1}else if(typeof i=="object"&&i!==null){if(!Object.values(i).every(l=>typeof l=="string"&&n.includes(l)))return!1}else return!1}}return!0}function Pe(e,r){let t=Object.keys(e.list);for(let o of t)if(o.includes("/")){let n=r(o);for(let i=0;i<n.length-1;i++){let l=n[i];if(!t.includes(l)&&l!==rt)return!1}}return!0}function It(e){return!e||typeof e!="object"||e instanceof Map?!1:Object.values(e).every(r=>typeof r=="string")}function Me(e){return!e||typeof e!="object"||e instanceof Map?!1:Object.values(e).every(r=>It(r))}var Fr="catalogs.yml",Qt=class{constructor(){this.cache=new Map}async read(r){let t=String(r.cwd),o=this.cache.get(t);if(o!==void 0)return o;let n=nt.ppath.join(r.cwd,Fr);if(!await nt.xfs.existsPromise(n))return this.cache.set(t,null),null;let i=await nt.xfs.readFilePromise(n,"utf8"),l=(0,bt.parseSyml)(i);if(!He(l))throw new ot("Invalid catalogs.yml format. Expected structure: { options?: {...}, list: { [alias: string]: { [packageName: string]: string } } }",ot.INVALID_FORMAT);if(!Pe(l,this.getInheritanceChain.bind(this)))throw new ot("Invalid inheritance structure in catalogs.yml. Parent groups must exist in the inheritance chain.",ot.INVALID_ALIAS);return this.cache.set(t,l),l}async getOptions(r){return(await this.read(r))?.options}async getAppliedCatalogs(r){let t=r.configuration.get("catalog"),o=r.configuration.get("catalogs"),n={};if(t&&typeof t=="object"&&(t instanceof Map?n[rt]=Object.fromEntries(t.entries()):It(t)&&(n[rt]=t)),o&&typeof o=="object")if(o instanceof Map)for(let[i,l]of o.entries())l instanceof Map?n[i]=Object.fromEntries(l.entries()):It(l)&&(n[i]=l);else Me(o)&&Object.assign(n,o);return n}async shouldIgnoreWorkspace(r){if(!r.manifest.name)return!1;let t=await this.read(r.project);return t?.options?.ignoredWorkspaces?(0,De.isMatch)(Ge.structUtils.stringifyIdent(r.manifest.name),t.options.ignoredWorkspaces):!1}async writeToYarnrc(r,t){let o=nt.ppath.join(r.cwd,".yarnrc.yml"),n={};if(await nt.xfs.existsPromise(o)){let l=await nt.xfs.readFilePromise(o,"utf8");n=(0,bt.parseSyml)(l)||{}}t.root&&Object.keys(t.root).length>0?n.catalog=t.root:delete n.catalog,Object.keys(t.named).length>0?n.catalogs=t.named:delete n.catalogs;let i=(0,bt.stringifySyml)(n);await nt.xfs.writeFilePromise(o,i)}resolveAllCatalogs(r){let t={named:{}};for(let[o,n]of Object.entries(r.list))o===rt?t.root={...n}:t.named[o]=this.resolveInheritedCatalog(o,r.list);return t}resolveInheritedCatalog(r,t){let o=this.getInheritanceChain(r),n={};for(let i of o){let l=t[i];if(!l)throw new ot(`Parent group "${i}" not found in inheritance chain for "${r}"`,ot.INVALID_ALIAS);Object.assign(n,l)}return n}getInheritanceChain(r){let t=r.split("/"),o=[];for(let n=0;n<t.length;n++)o.push(t.slice(0,n+1).join("/"));return o}clearCache(r){this.cache.delete(String(r.cwd))}},P=new Qt;var kt=class extends Be.BaseCommand{constructor(){super(...arguments);this.dryRun=Nt.Option.Boolean("--dry-run",!1,{description:"Preview changes without writing to .yarnrc.yml"})}static{this.paths=[["catalogs","apply"]]}static{this.usage=Nt.Command.Usage({category:"Catalogs commands",description:"Apply catalog definitions from catalogs.yml to .yarnrc.yml",details:`
      This command reads catalog definitions from catalogs.yml, resolves all inheritance,
      and writes them to .yarnrc.yml in Yarn's native catalog format.

      The catalogs.yml file should contain hierarchical catalog definitions with optional inheritance.
      After running this command, Yarn will use its native catalog resolution for dependencies.
    `,examples:[["Apply catalogs to .yarnrc.yml","yarn catalogs apply"],["Preview changes without writing","yarn catalogs apply --dry-run"]]})}async execute(){let t=await gt.Configuration.find(this.context.cwd,this.context.plugins),{project:o}=await gt.Project.find(t,this.context.cwd);return(await gt.StreamReport.start({configuration:t,stdout:this.context.stdout},async i=>{let l=await P.read(o);if(!l){i.reportError(0,"No catalogs.yml file found in project root. Please create one to use this command.");return}let f=P.resolveAllCatalogs(l),g=f.root?1:0,h=Object.keys(f.named).length;if(this.dryRun){if(i.reportInfo(0,j.bold("Dry run mode - no files will be modified")),i.reportSeparator(),f.root){i.reportInfo(0,j.bold("Root catalog:"));for(let[R,I]of Object.entries(f.root))i.reportInfo(0,`  ${j.cyan(R)}: ${I}`);i.reportSeparator()}if(h>0){i.reportInfo(0,j.bold("Named catalogs:"));for(let[R,I]of Object.entries(f.named)){i.reportInfo(0,j.yellow(`  ${R}:`));for(let[v,M]of Object.entries(I))i.reportInfo(0,`    ${j.cyan(v)}: ${M}`)}i.reportSeparator()}i.reportInfo(0,`Would apply ${g>0?"1 root catalog":"no root catalog"}${g>0&&h>0?" and":""}${h>0?` ${h} named catalog group${h>1?"s":""}`:""} to .yarnrc.yml`)}else await P.writeToYarnrc(o,f),P.clearCache(o),i.reportInfo(0,j.green(`\u2713 Applied ${g>0?"1 root catalog":"no root catalog"}${g>0&&h>0?" and":""}${h>0?` ${h} named catalog group${h>1?"s":""}`:""} to .yarnrc.yml`))})).exitCode()}};var Ht=K("@yarnpkg/core");async function je(e){let r=await P.shouldIgnoreWorkspace(e),t=[...Object.values(e.manifest.raw.dependencies||{}),...Object.values(e.manifest.raw.devDependencies||{})].some(i=>i.startsWith(J)),o=r&&t,n=[];return r||(n=await Vr(e)),{shouldIgnore:r,catalogProtocolViolations:n,ignoredWorkspaceWithCatalogProtocol:o}}async function Zt(e,r){if(r.range.startsWith(J)||await P.shouldIgnoreWorkspace(e))return null;let t=await zt(e),o=Ht.structUtils.stringifyIdent(r),i=(await We(e.project,o)).flatMap(({groupName:f})=>t.length===0||t.includes(f)?[f]:[]);return i.length===0?null:{validationLevel:await Yr(e,o),applicableGroups:i}}async function Vr(e){let r=[...Object.entries(e.manifest.raw.dependencies??{}),...Object.entries(e.manifest.raw.devDependencies??{})].map(([o,n])=>{let i=Ht.structUtils.parseIdent(o);return Ht.structUtils.makeDescriptor(i,n)}),t=[];for(let o of r){let n=await Zt(e,o);n&&n.validationLevel!=="off"&&t.push({descriptor:o,validationLevel:n.validationLevel,applicableGroups:n.applicableGroups})}return t}async function Ur(e,r){let o=(await P.getOptions(e.project))?.validation||"warn";if(typeof o=="string")return o;let n=P.getInheritanceChain(r);for(let i=n.length-1;i>=0;i--){let l=n[i];if(o[l]!==void 0)return o[l]}return"warn"}async function Yr(e,r){let t=(await We(e.project,r)).map(({groupName:n})=>n);if(t.length===0)return"off";let o=[];for(let n of t){let i=await Ur(e,n);o.push(i)}return o.includes("strict")?"strict":o.includes("warn")?"warn":"off"}async function We(e,r){let t=await P.getAppliedCatalogs(e),o=[];if(!t||Object.keys(t).length===0)return o;for(let[n,i]of Object.entries(t)){let l=i[r];l&&o.push({groupName:n,version:l})}return o}async function Jt(e,r){if(r.range.startsWith(J)){if(await P.shouldIgnoreWorkspace(e))throw new Error(j.red("The workspace is ignored from the catalogs, but the dependency to add is using the catalog protocol. Consider removing the protocol."));return}let t=await Zt(e,r);if(!t)return;let{validationLevel:o,applicableGroups:n}=t,i=await zt(e);if(i.length>0){for(let h of i)if(n.includes(h)){let R=h===rt?J:`${J}${h}`;r.range=R;return}}let l=n.map(h=>h===rt?"":h),f=l.filter(h=>h!=="").length>0?` (${l.join(", ")})`:"",g=`\u27A4 ${r.name} is listed in the catalogs config${f}, but it seems you're adding it without the catalog protocol. Consider running 'yarn add ${r.name}@${J}${l[0]}' instead.`;if(o==="strict")throw new Error(j.red(g));o==="warn"&&console.warn(j.yellow(g))}async function zt(e){let r=await P.getOptions(e.project);if(r){if(await P.shouldIgnoreWorkspace(e))return[];if(r.default){if(Array.isArray(r.default))return r.default;if(r.default==="max"){let t=await P.getAppliedCatalogs(e.project),o=Object.keys(t||{}),n=[...e.manifest.dependencies,...e.manifest.devDependencies],i=Object.fromEntries(o.map(f=>[f,0]));for(let[f,g]of n)if(g.range.startsWith(J)){let h=g.range.substring(J.length);i[h]=(i[h]||0)+1}let l=Math.max(...Object.values(i));return Object.keys(i).filter(f=>i[f]===l)}}}return[]}var Kr={commands:[kt],hooks:{validateWorkspace:async(e,r)=>{let t=await je(e);if(t.catalogProtocolViolations.length>0){let o=t.catalogProtocolViolations.filter(l=>l.validationLevel==="strict"),n=t.catalogProtocolViolations.filter(l=>l.validationLevel==="warn"),i=l=>`The following dependencies are listed in the catalogs but not using the catalog protocol: ${l.map(g=>j.yellow(dt.structUtils.stringifyDescriptor(g.descriptor))).join(", ")}. Consider using the catalog protocol instead.`;o.length>0&&r.reportError(dt.MessageName.INVALID_MANIFEST,i(o)),n.length>0&&r.reportWarning(dt.MessageName.INVALID_MANIFEST,i(n))}t.ignoredWorkspaceWithCatalogProtocol&&r.reportError(dt.MessageName.INVALID_MANIFEST,"Workspace is ignored from the catalogs, but it has dependencies with the catalog protocol. Consider removing the protocol.")},afterWorkspaceDependencyAddition:async(e,r,t)=>{Jt(e,t)},afterWorkspaceDependencyReplacement:async(e,r,t,o)=>{Jt(e,o)}}},Xr=Kr;return Ze(qr);})();
return plugin;
}
};
