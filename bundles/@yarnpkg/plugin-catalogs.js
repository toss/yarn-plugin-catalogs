/* eslint-disable */
//prettier-ignore
module.exports = {
name: "@yarnpkg/plugin-catalogs",
factory: function (require) {
var plugin=(()=>{var C=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var I=Object.getOwnPropertyNames;var h=Object.prototype.hasOwnProperty;var _=(o=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(o,{get:(t,n)=>(typeof require<"u"?require:t)[n]}):o)(function(o){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+o+'" is not supported')});var w=(o,t)=>{for(var n in t)C(o,n,{get:t[n],enumerable:!0})},L=(o,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let e of I(t))!h.call(o,e)&&e!==n&&C(o,e,{get:()=>t[e],enumerable:!(r=d(t,e))||r.enumerable});return o};var m=o=>L(C({},"__esModule",{value:!0}),o);var N={};w(N,{default:()=>y});var g=_("@yarnpkg/core");var p="YARN__PLUGIN__CATALOG__DEFAULT__GROUP",s=class extends Error{constructor(n,r){super(n);this.code=r;this.name="CatalogConfigurationError"}static{this.FILE_NOT_FOUND="FILE_NOT_FOUND"}static{this.INVALID_FORMAT="INVALID_FORMAT"}static{this.INVALID_ALIAS="INVALID_ALIAS"}},l=class{constructor(){this.configCache=new Map}async readConfiguration(t){let r=t.cwd,e=this.configCache.get(r);if(e)return e;let c=t.configuration.get("catalogs"),a=Object.entries(c).reduce((i,[f,u])=>(typeof u=="string"?i[p]={...i[p]||{},[f]:u}:i[f]=u,i),{});if(!this.isValidConfiguration(a))throw new s("Invalid catalogs configuration format. Expected structure: { [alias: string]: { [packageName: string]: string } }",s.INVALID_FORMAT);return this.configCache.set(r,a),a}async getRange(t,n,r){let e=await this.readConfiguration(t),c=n.length===0?p:n,a=e[c];if(!a)throw new s(`Alias "${c}" not found in .yarnrc.yml catalogs.`,s.INVALID_ALIAS);let i=a[r];if(!i)throw new s(`Package "${r}" not found in alias "${c}"`,s.INVALID_ALIAS);return/^[^:]+:/.test(i)?i:`${t.configuration.get("defaultProtocol")}${i}`}clearCache(t){this.configCache.delete(t)}isValidConfiguration(t){if(!t||typeof t!="object")return!1;for(let[n,r]of Object.entries(t)){if(!r||typeof r!="object")return!1;for(let e of Object.values(r))if(typeof e!="string")return!1}return!0}};var A="catalog:",D=new l,O={configuration:{catalogs:{description:"Define dependency version ranges as reusable constants across your project.",type:g.SettingsType.ANY,default:{}}},hooks:{reduceDependency:async(o,t,...n)=>{if(!o.range.startsWith(A))return o;try{let r=o.range.slice(A.length),e=g.structUtils.stringifyIdent(o),c=await D.getRange(t,r,e),a=g.structUtils.makeDescriptor(g.structUtils.makeIdent(o.scope,o.name),c),i=await t.configuration.reduceHook(f=>f.reduceDependency,a,t,...n);return i!==a?i:a}catch(r){throw r instanceof s?new Error(`Failed to resolve ${g.structUtils.stringifyDescriptor(o)}: ${r.message}`):r}}}},y=O;return m(N);})();
return plugin;
}
};
